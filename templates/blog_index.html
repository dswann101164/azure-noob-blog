{% extends "base.html" %}

{% block content %}
<header class="post-header">
  <h1>Blog</h1>
  <p class="summary">Latest posts from {{ site_name }}.</p>
</header>

<div class="tags-cloud" style="margin-bottom: 16px;">
  <a class="tag-chip" href="{{ url_for('tags_index') }}">Browse all tags →</a>
  <a class="tag-chip" href="{{ url_for('search_page') }}">Search</a>
</div>

<ul class="post-list">
  {% for p in posts %}
  <li>
    <article class="post">
      {% if p.cover %}
        {# Build a safe URL from either absolute or relative cover paths #}
        {% if p.cover.startswith('/') %}
          {% set cover_url = p.cover %}
        {% elif p.cover.startswith('images/') or p.cover.startswith('img/') %}
          {% set cover_url = url_for('static', filename=p.cover) %}
        {% else %}
          {% set cover_url = url_for('static', filename='images/' ~ p.cover) %}
        {% endif %}

        <div class="hero">
          <a href="{{ url_for('blog_post', slug=p.slug) }}">
            <img src="{{ cover_url }}" alt="{{ p.title }}" class="post-cover">
          </a>
        </div>
      {% endif %}

      <header>
        <h2 class="post-title">
          <a href="{{ url_for('blog_post', slug=p.slug) }}">{{ p.title }}</a>
        </h2>
        <p class="meta">{{ p.date|ymd }}{% if p.tags and p.tags|length %} · {{ p.tags|join(", ") }}{% endif %}</p>
      </header>

      {% if p.summary %}
        <p class="summary">{{ p.summary }}</p>
      {% endif %}

      <a class="btn" href="{{ url_for('blog_post', slug=p.slug) }}">Read more →</a>
    </article>
  </li>
  {% endfor %}
</ul>
{% endblock %}
