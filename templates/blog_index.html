{% extends "base.html" %}

{% block content %}
<header class="post-header">
  <h1>Blog</h1>
  <p class="summary">Latest posts from {{ site_name }}.</p>
</header>

<div class="tags-cloud" style="margin-bottom: 16px;">
  <a class="tag-chip" href="{{ url_for('tags_index') }}">Browse all tags →</a>
  <a class="tag-chip" href="{{ url_for('search_page') }}">Search</a>
</div>

<ul class="post-list">
  {% for p in posts %}
  <li>
    <article class="post">
      {# ----- COVER (index hero) ----- #}
      {% set cover = p.cover | default('') %}
      {% if cover %}
        {% if cover.startswith('/') %}
          {% set cover_url = cover %}
        {% elif cover.startswith('images/') or cover.startswith('img/') %}
          {% set cover_url = url_for('static', filename=cover) %}
        {% else %}
          {# treat bare filenames as /static/images/hero/<file> to match post template #}
          {% set cover_url = url_for('static', filename='images/hero/' ~ cover) %}
        {% endif %}

        <div class="hero hero-index">
          <a href="{{ url_for('blog_post', slug=p.slug) }}">
            <img src="{{ cover_url }}" alt="{{ p.title }}" loading="lazy">
          </a>
        </div>
      {% endif %}

      <header>
        <h2 class="post-title">
          <a href="{{ url_for('blog_post', slug=p.slug) }}">{{ p.title }}</a>
        </h2>
        <p class="meta">
          {{ p.date|ymd }}
          {% if p.tags and p.tags|length %} · {{ p.tags|join(", ") }}{% endif %}
        </p>
      </header>

      {% if p.summary %}
        <p class="summary">{{ p.summary }}</p>
      {% endif %}

      <a class="btn" href="{{ url_for('blog_post', slug=p.slug) }}">Read more →</a>
    </article>
  </li>
  {% endfor %}
</ul>
{% endblock %}
