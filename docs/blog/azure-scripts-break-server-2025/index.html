<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  

  <!-- Primary SEO -->
  <title>Azure Noob</title>
  <meta name="description" content="Don&#39;t be a Noob">
  <link rel="canonical" href="https://azure-noob.com" />

  <!-- Favicons -->
  <link rel="icon" href="../../static/images/logo.png">

  <!-- Open Graph -->
  <meta property="og:title" content="Azure Noob">
  <meta property="og:description" content="Don&#39;t be a Noob">
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://azure-noob.com">
  <meta property="og:image" content="../../static/images/hero/cloud-wars.png">

  

  <!-- Twitter -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="Azure Noob">
  <meta name="twitter:description" content="Don&#39;t be a Noob">
  <meta name="twitter:image" content="../../static/images/hero/cloud-wars.png">

  <!-- Styles -->
  <link rel="stylesheet" href="../../static/styles.css">
  <!-- Quest styles -->

  <!-- Google Analytics -->
  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-ZNHGEB0BNZ"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-ZNHGEB0BNZ');
  </script>
</head>
<body>
  <header class="site-header">
    <div class="wrap nav-wrap">
      <div class="brand-block">
        <a href="../../index.html" class="brand-link">
          <img src="../../static/images/logo.png" alt="Azure Noob logo" class="logo">
        </a>
        <span class="brand-text">
          <small>Official Website of</small>
          <strong>Azure Noob</strong>
        </span>
      </div>
      <nav class="nav">
        <a href="../../index.html">Home</a>
        <a href="../index.html">Blog</a>
        <a href="../../about/index.html">About</a>
        <a href="../../tags/index.html">Tags</a>
        <a href="../../search/index.html">Search</a>
      </nav>
    </div>
  </header>

  <!-- WW2 Quest banner (appears on all pages; remove if you want home-only) -->
  <!-- Audio (tiny files; optional) -->

  <main class="site-content">
    <div class="wrap">
      
<article class="post">

  
  
    <div class="hero">
      <img src="/static/images/hero/powershell-version-gap.png" alt="Why Your Azure Scripts Break on Fresh Server 2025 (And Why Microsoft Won&#39;t Tell You)">
    </div>
  

  <header class="post-header">
    <h1>Why Your Azure Scripts Break on Fresh Server 2025 (And Why Microsoft Won&#39;t Tell You)</h1>
    <p class="muted">
      2025-10-06 ¬∑ ~15 min read
       ¬∑ Azure, PowerShell, Automation, Windows Server
    </p>
    
      <p class="summary">Your admin workstation still has ISE installed. Server 2025 still ships with PowerShell 5.1. Modern Azure automation needs PowerShell 7. Here&#39;s the gap nobody explains.</p>
    
  </header>

  
  <p class="post-actions" style="margin:.5rem 0 0;">
    <button class="btn print-trigger"
            onclick="window.print(); return false;"
            title="Print this page"
            aria-label="Print this page">üñ®Ô∏è Print this page</button>
  </p>

  
  <div class="post-body">
    <h2>The Problem Nobody Warns You About</h2>
<p>Working from my Citrix VDI session last week. Opened PowerShell ISE (right there in the Start menu, familiar, convenient). Tried to run an Azure Resource Graph query to export tags from 44 subscriptions. Failed with cryptic errors about <code>-Skip</code> parameter validation.</p>
<p>My admin workstation: PowerShell 5.1 + ISE installed by default.</p>
<p>Azure servers I manage: Windows Server 2025, also PowerShell 5.1 by default.</p>
<p>Modern Azure automation: Requires PowerShell 7 for many features.</p>
<p><strong>The disconnect:</strong> Microsoft deprecated ISE in 2020 but keeps shipping it. Server 2025 defaults to PowerShell 5.1 from 2016. Nothing forces the upgrade. Scripts silently break with confusing errors.</p>
<h2>The Azure Admin Workstation Reality</h2>
<p>You're not writing PowerShell on Azure servers. You're writing it from your workstation:<br />
- Citrix VDI session<br />
- Azure Virtual Desktop<br />
- Physical Windows machine<br />
- Jump box with Azure access</p>
<p><strong>That workstation probably has:</strong><br />
- Windows 10 or 11 (ships with PowerShell 5.1 + ISE)<br />
- Corporate image with "approved tools" (ISE is approved, VSCode might not be)<br />
- Limited admin rights (can't install whatever you want)</p>
<p><strong>What you need for modern Azure automation:</strong><br />
- PowerShell 7 on your workstation (to write and test scripts)<br />
- VSCode instead of ISE (Microsoft's recommended editor since 2020)<br />
- Understanding of what runs on Azure servers vs your workstation</p>
<h2>What Breaks: Real Code Examples</h2>
<h3>Example 1: Azure Resource Graph Pagination</h3>
<p>This script needs to query 44 Azure subscriptions for tag data:</p>
<div class="codehilite"><pre><span></span><code><span class="c"># Run from your admin workstation</span>
<span class="nv">$subscriptionIds</span> <span class="p">=</span> <span class="p">(</span><span class="nb">Get-AzSubscription</span><span class="p">).</span><span class="n">Id</span>
<span class="nv">$allResources</span> <span class="p">=</span> <span class="p">@()</span>
<span class="nv">$skip</span> <span class="p">=</span> <span class="n">0</span>
<span class="nv">$batchSize</span> <span class="p">=</span> <span class="n">1000</span>

<span class="k">do</span> <span class="p">{</span>
    <span class="nv">$batch</span> <span class="p">=</span> <span class="nb">Search-AzGraph</span> <span class="n">-Query</span> <span class="s2">&quot;Resources | project id, tags&quot;</span> <span class="n">-Subscription</span> <span class="nv">$subscriptionIds</span> <span class="n">-First</span> <span class="nv">$batchSize</span> <span class="n">-Skip</span> <span class="nv">$skip</span>
    <span class="nv">$allResources</span> <span class="p">+=</span> <span class="nv">$batch</span>
    <span class="nv">$skip</span> <span class="p">+=</span> <span class="nv">$batchSize</span>
    <span class="nb">Write-Host</span> <span class="s2">&quot;Fetched </span><span class="p">$(</span><span class="nv">$allResources</span><span class="p">.</span><span class="n">Count</span><span class="p">)</span><span class="s2"> resources...&quot;</span>
<span class="p">}</span> <span class="k">while</span> <span class="p">(</span><span class="nv">$batch</span><span class="p">.</span><span class="n">Count</span> <span class="o">-eq</span> <span class="nv">$batchSize</span><span class="p">)</span>
</code></pre></div>

<p><strong>PowerShell 5.1 error (from ISE on your workstation):</strong></p>
<div class="codehilite"><pre><span></span><code>Search-AzGraph: Cannot validate argument on parameter &#39;Skip&#39;. 
The 0 argument is less than the minimum allowed range of 1.
</code></pre></div>

<p><strong>PowerShell 7 on your workstation:</strong> Works perfectly.</p>
<p><strong>Why it matters:</strong> You're querying Azure from your workstation. If your workstation has PowerShell 5.1, your automation breaks before it ever touches Azure servers.</p>
<h3>Example 2: Parallel Processing for Multi-Subscription Queries</h3>
<p>Querying 44 subscriptions serially takes forever:</p>
<div class="codehilite"><pre><span></span><code><span class="c"># PowerShell 7 - runs on your workstation</span>
<span class="nv">$subscriptions</span> <span class="p">|</span> <span class="k">ForEach</span><span class="n">-Object</span> <span class="n">-Parallel</span> <span class="p">{</span>
    <span class="nb">Search-AzGraph</span> <span class="n">-Query</span> <span class="s2">&quot;Resources&quot;</span> <span class="n">-Subscription</span> <span class="nv">$_</span><span class="p">.</span><span class="n">Id</span>
<span class="p">}</span> <span class="n">-ThrottleLimit</span> <span class="n">5</span>
</code></pre></div>

<p><strong>PowerShell 5.1 error:</strong></p>
<div class="codehilite"><pre><span></span><code>ForEach-Object: A parameter cannot be found that matches parameter name &#39;Parallel&#39;.
</code></pre></div>

<p><strong>Performance difference:</strong><br />
- PowerShell 5.1 serial: 2+ minutes for 44 subscriptions<br />
- PowerShell 7 parallel: 28 seconds</p>
<p><strong>Where this runs:</strong> On your admin workstation making Azure API calls. Server PowerShell version doesn't matter for this.</p>
<h3>Example 3: Ternary Operators for Cleaner Logic</h3>
<p>Building Azure cost allocation reports:</p>
<div class="codehilite"><pre><span></span><code><span class="c"># PowerShell 7 - clean syntax</span>
<span class="nv">$costCenter</span> <span class="p">=</span> <span class="nv">$tags</span><span class="p">[</span><span class="s2">&quot;Cost Center&quot;</span><span class="p">]</span> <span class="p">?</span> <span class="nv">$tags</span><span class="p">[</span><span class="s2">&quot;Cost Center&quot;</span><span class="p">]</span> <span class="p">:</span> <span class="s2">&quot;Unallocated&quot;</span>
<span class="nv">$status</span> <span class="p">=</span> <span class="nv">$vm</span><span class="p">.</span><span class="n">PowerState</span> <span class="o">-eq</span> <span class="s2">&quot;Running&quot;</span> <span class="p">?</span> <span class="s2">&quot;Online&quot;</span> <span class="p">:</span> <span class="s2">&quot;Offline&quot;</span>
</code></pre></div>

<p><strong>PowerShell 5.1 error:</strong></p>
<div class="codehilite"><pre><span></span><code><span class="n">ParserError</span><span class="o">:</span><span class="w"> </span><span class="n">Unexpected</span><span class="w"> </span><span class="n">token</span><span class="w"> </span><span class="s1">&#39;?&#39;</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">expression</span><span class="w"> </span><span class="n">or</span><span class="w"> </span><span class="n">statement</span><span class="o">.</span>
</code></pre></div>

<p><strong>Fix:</strong> Use verbose if/else blocks. But your scripts get longer and harder to read.</p>
<h3>Example 4: Null Coalescing for Tag Defaults</h3>
<p>Handling missing Azure resource tags:</p>
<div class="codehilite"><pre><span></span><code><span class="c"># PowerShell 7 - concise</span>
<span class="nv">$owner</span> <span class="p">=</span> <span class="nv">$tags</span><span class="p">.</span><span class="n">Owner</span> <span class="p">??</span> <span class="nv">$tags</span><span class="p">.</span><span class="n">ContactEmail</span> <span class="p">??</span> <span class="s2">&quot;Unknown&quot;</span>
<span class="nv">$env</span> <span class="p">=</span> <span class="nv">$tags</span><span class="p">.</span><span class="n">Environment</span> <span class="p">??</span> <span class="s2">&quot;Production&quot;</span>
</code></pre></div>

<p><strong>PowerShell 5.1:</strong> No <code>??</code> operator, needs manual null checking.</p>
<h2>The ISE Trap</h2>
<p>PowerShell ISE is pre-installed on your Windows workstation. It's right there in the Start menu. You've been using it for years. It works for basic scripts.</p>
<p><strong>What ISE doesn't tell you:</strong><br />
- Last feature update: 2016<br />
- Can't run PowerShell 7 (even if you install it on your machine)<br />
- Microsoft officially recommends VSCode since 2020<br />
- Deprecated but not removed (still ships with Windows 11 and Server 2025)</p>
<p><strong>The problem:</strong> ISE seems to work fine until you hit modern Azure cmdlet requirements. Then you're debugging cryptic errors instead of writing automation.</p>
<h2>When Server PowerShell Version Matters vs When It Doesn't</h2>
<p><strong>Your workstation PowerShell version matters when:</strong><br />
- Writing and testing scripts locally<br />
- Running Azure Resource Graph queries<br />
- Exporting cost data via Az PowerShell modules<br />
- Automating Azure resources interactively</p>
<p><strong>Azure server PowerShell version matters when:</strong><br />
- Deploying scripts to run via Azure Automation runbooks<br />
- Using VM Run Command to execute scripts on servers<br />
- Running scheduled tasks on Azure VMs<br />
- Installing Azure agents or extensions that use PowerShell</p>
<p><strong>Example scenario:</strong></p>
<p>You write a script on your workstation (needs PowerShell 7 for parallel processing). Script creates Azure VMs. Those VMs run Server 2025 (has PowerShell 5.1 by default).</p>
<ul>
<li>Your workstation: Needs PowerShell 7 to write/test the VM creation script</li>
<li>Azure servers: Don't matter for VM creation (Azure API doesn't care)</li>
<li>Azure servers: Matter if you deploy scripts TO them after creation</li>
</ul>
<h2>Your Admin Workstation Setup</h2>
<p><strong>Check your current PowerShell version:</strong></p>
<div class="codehilite"><pre><span></span><code><span class="c"># Run this in any PowerShell window</span>
<span class="nv">$PSVersionTable</span><span class="p">.</span><span class="n">PSVersion</span>

<span class="c"># Output shows version</span>
<span class="n">Major</span>  <span class="n">Minor</span>  <span class="n">Build</span>  <span class="n">Revision</span>
<span class="p">-----</span>  <span class="p">-----</span>  <span class="p">-----</span>  <span class="p">--------</span>
<span class="n">5</span>      <span class="n">1</span>      <span class="n">22621</span>  <span class="n">4249</span>      <span class="c"># PowerShell 5.1 (default on Windows 10/11)</span>
</code></pre></div>

<p>If you see 5.1, modern Azure automation will hit compatibility issues.</p>
<p><strong>Installing PowerShell 7 on your workstation:</strong></p>
<p><strong>If you have admin rights:</strong></p>
<div class="codehilite"><pre><span></span><code><span class="c"># Option 1: winget (if available)</span>
<span class="n">winget</span> <span class="n">install</span> <span class="n">Microsoft</span><span class="p">.</span><span class="n">PowerShell</span>

<span class="c"># Option 2: Chocolatey</span>
<span class="nb">Set-ExecutionPolicy</span> <span class="n">Bypass</span> <span class="n">-Scope</span> <span class="k">Process</span> <span class="n">-Force</span>
<span class="nb">iex </span><span class="p">((</span><span class="nb">New-Object</span> <span class="n">System</span><span class="p">.</span><span class="n">Net</span><span class="p">.</span><span class="n">WebClient</span><span class="p">).</span><span class="n">DownloadString</span><span class="p">(</span><span class="s1">&#39;https://community.chocolatey.org/install.ps1&#39;</span><span class="p">))</span>
<span class="n">choco</span> <span class="n">install</span> <span class="n">powershell-core</span> <span class="n">-y</span>

<span class="c"># Option 3: MSI installer</span>
<span class="c"># Download from: https://github.com/PowerShell/PowerShell/releases</span>
<span class="c"># Run PowerShell-7.5.0-win-x64.msi</span>
</code></pre></div>

<p><strong>If you DON'T have admin rights:</strong></p>
<p>Option 1: Request IT to install PowerShell 7 via corporate software catalog.</p>
<p>Option 2: Use Azure Cloud Shell (has PowerShell 7 built-in, no installation needed):<br />
- portal.azure.com ‚Üí Cloud Shell icon<br />
- Already authenticated to Azure<br />
- PowerShell 7.x by default</p>
<p>Option 3: Portable PowerShell (no admin required):</p>
<div class="codehilite"><pre><span></span><code><span class="c"># Download portable ZIP</span>
<span class="nv">$url</span> <span class="p">=</span> <span class="s2">&quot;https://github.com/PowerShell/PowerShell/releases/download/v7.5.0/PowerShell-7.5.0-win-x64.zip&quot;</span>
<span class="nb">Invoke-WebRequest</span> <span class="n">-Uri</span> <span class="nv">$url</span> <span class="n">-OutFile</span> <span class="s2">&quot;$env:USERPROFILE\Downloads\PowerShell7.zip&quot;</span>

<span class="c"># Extract to your user profile</span>
<span class="nb">Expand-Archive</span> <span class="n">-Path</span> <span class="s2">&quot;$env:USERPROFILE\Downloads\PowerShell7.zip&quot;</span> <span class="n">-DestinationPath</span> <span class="s2">&quot;$env:USERPROFILE\PowerShell7&quot;</span>

<span class="c"># Run PowerShell 7</span>
<span class="p">&amp;</span> <span class="s2">&quot;$env:USERPROFILE\PowerShell7\pwsh.exe&quot;</span>
</code></pre></div>

<h2>Moving from ISE to VSCode</h2>
<p><strong>The reality check:</strong> ISE can only run PowerShell 5.1. Even if you install PowerShell 7, ISE won't use it.</p>
<p>VSCode runs both versions and lets you switch between them.</p>
<p><strong>Installing VSCode on your workstation:</strong></p>
<div class="codehilite"><pre><span></span><code><span class="c"># With Chocolatey</span>
<span class="n">choco</span> <span class="n">install</span> <span class="n">vscode</span> <span class="n">-y</span>

<span class="c"># Or download: https://code.visualstudio.com</span>
</code></pre></div>

<p><strong>Install PowerShell extension:</strong><br />
1. Open VSCode<br />
2. Extensions panel (Ctrl+Shift+X)<br />
3. Search: "PowerShell"<br />
4. Install (by Microsoft)</p>
<p><strong>Set PowerShell 7 as default:</strong><br />
1. Open settings (Ctrl+,)<br />
2. Search: "terminal.integrated.defaultProfile.windows"<br />
3. Select: "PowerShell"<br />
4. Search: "powershell.powerShellDefaultVersion"<br />
5. Select: PowerShell 7.x</p>
<p><strong>Key difference from ISE:</strong><br />
- <strong>F8 in both tools:</strong> Run selected code<br />
- <strong>VSCode advantage:</strong> Integrated terminal, works with PowerShell 7, IntelliSense, Git integration<br />
- <strong>ISE limitation:</strong> Can't use PowerShell 7, deprecated, no new features</p>
<h2>Workflow Changes</h2>
<p><strong>Before (ISE + PowerShell 5.1 on your workstation):</strong><br />
1. Open ISE from Start menu<br />
2. Write script to query Azure Resource Graph<br />
3. F5 to run entire script<br />
4. Wait 2 minutes while it queries 44 subscriptions serially<br />
5. Hit cryptic <code>-Skip</code> parameter error<br />
6. Debug for 30 minutes</p>
<p><strong>After (VSCode + PowerShell 7 on your workstation):</strong><br />
1. Open VSCode (pin to taskbar)<br />
2. Create <code>.ps1</code> file<br />
3. Write query with <code>-Parallel</code> for fast execution<br />
4. F8 to test code section-by-section<br />
5. Query completes in 28 seconds<br />
6. No parameter validation errors</p>
<p><strong>Key improvement:</strong> Test code incrementally with F8 instead of running full scripts and debugging failures.</p>
<h2>Compatibility: Running Old Scripts</h2>
<p>You don't have to rewrite everything immediately. VSCode can run both PowerShell versions.</p>
<p><strong>Switch versions in VSCode:</strong><br />
1. Click PowerShell version indicator (bottom-right)<br />
2. Select "Windows PowerShell (5.1)" or "PowerShell 7.5.0"<br />
3. Script runs in selected version</p>
<p><strong>Use this for:</strong><br />
- Testing existing scripts before migration<br />
- Running legacy scripts that depend on 5.1-specific behavior<br />
- Gradual migration without breaking production automation</p>
<h2>When You Need PowerShell 7 on Azure Servers</h2>
<p>Most of your Azure automation runs from your workstation (calling Azure APIs). But some scenarios require PowerShell on the servers themselves:</p>
<p><strong>Azure Automation runbooks:</strong><br />
- Run scripts inside Azure Automation accounts<br />
- Default runtime: PowerShell 5.1<br />
- Can specify PowerShell 7.2 runtime (must explicitly select)</p>
<p><strong>VM Run Command:</strong><br />
- Execute scripts directly on Azure VMs<br />
- Uses whatever PowerShell version is installed on that VM<br />
- Server 2025 VMs default to PowerShell 5.1</p>
<p><strong>VM Custom Script Extensions:</strong><br />
- Deploy scripts that run during VM provisioning<br />
- Uses VM's default PowerShell (5.1 on Server 2025)</p>
<p><strong>Solution:</strong> Include PowerShell 7 installation in your VM deployment automation if scripts require it.</p>
<h2>Real-World Scenario: Tag Cleanup Automation</h2>
<p><strong>Problem:</strong> Need to audit and fix Azure resource tags across 44 subscriptions.</p>
<p><strong>Your workstation script (needs PowerShell 7):</strong></p>
<div class="codehilite"><pre><span></span><code><span class="c"># This runs on YOUR workstation, not Azure servers</span>
<span class="nb">Connect-AzAccount</span>

<span class="nv">$subscriptionIds</span> <span class="p">=</span> <span class="p">(</span><span class="nb">Get-AzSubscription</span><span class="p">).</span><span class="n">Id</span>

<span class="c"># PowerShell 7 parallel processing</span>
<span class="nv">$allResources</span> <span class="p">=</span> <span class="nv">$subscriptionIds</span> <span class="p">|</span> <span class="k">ForEach</span><span class="n">-Object</span> <span class="n">-Parallel</span> <span class="p">{</span>
    <span class="nb">Search-AzGraph</span> <span class="n">-Query</span> <span class="s2">&quot;Resources | project id, name, tags&quot;</span> <span class="n">-Subscription</span> <span class="nv">$_</span>
<span class="p">}</span> <span class="n">-ThrottleLimit</span> <span class="n">5</span>

<span class="c"># Export for analysis</span>
<span class="nv">$allResources</span> <span class="p">|</span> <span class="nb">Export-Csv</span> <span class="n">C</span><span class="p">:\</span><span class="n">temp</span><span class="p">\</span><span class="n">tags</span><span class="p">.</span><span class="n">csv</span> <span class="n">-NoTypeInformation</span>
</code></pre></div>

<p><strong>Why PowerShell 7 matters here:</strong><br />
- Runs on your workstation (not Azure servers)<br />
- <code>-Parallel</code> dramatically speeds up 44-subscription queries<br />
- Newer Az modules work better with PowerShell 7<br />
- No <code>-Skip</code> parameter bugs</p>
<p><strong>Where Azure server PowerShell version doesn't matter:</strong><br />
- This script calls Azure management APIs from your workstation<br />
- Azure servers aren't involved in this query<br />
- Tag updates happen via API, not by logging into servers</p>
<h2>Corporate Environments and Tool Approvals</h2>
<p><strong>The common blocker:</strong> "IT won't let me install VSCode or PowerShell 7."</p>
<p><strong>Arguments for IT:</strong></p>
<ol>
<li><strong>Microsoft's official recommendation:</strong></li>
<li>Microsoft deprecated ISE in 2020</li>
<li>Microsoft recommends VSCode for PowerShell since 2020</li>
<li>
<p>Server 2025 ships with ISE but it's not supported for modern work</p>
</li>
<li>
<p><strong>PowerShell 7 is Microsoft-signed and official:</strong></p>
</li>
<li>Not third-party software</li>
<li>Available via Microsoft's official channels</li>
<li>
<p>Required for many modern Azure modules</p>
</li>
<li>
<p><strong>Productivity impact:</strong></p>
</li>
<li>Parallel processing saves hours on multi-subscription tasks</li>
<li>Modern syntax reduces script complexity</li>
<li>
<p>Better debugging and error messages</p>
</li>
<li>
<p><strong>VSCode is Microsoft's tool:</strong></p>
</li>
<li>Owned by Microsoft (same as PowerShell ISE)</li>
<li>Free, open-source</li>
<li>Standard tool for Azure development</li>
</ol>
<p><strong>Compromise options:</strong><br />
- Install PowerShell 7, keep using ISE for now (limited benefit but better than nothing)<br />
- Use Azure Cloud Shell for PowerShell 7 without installing anything<br />
- Request VSCode + PowerShell 7 in next workstation image refresh</p>
<h2>Beyond PowerShell: Azure Extensions for VSCode</h2>
<p>VSCode isn't just for PowerShell. Install these extensions to manage Azure resources directly from your editor:</p>
<p><strong>Essential Azure extensions:</strong></p>
<ol>
<li><strong>Azure Account</strong> - Sign in to Azure, manage subscriptions</li>
<li><strong>Azure Resources</strong> - View and manage all Azure resources in sidebar</li>
<li><strong>Azure Functions</strong> - Create, test, and deploy Azure Functions</li>
<li><strong>Azure App Service</strong> - Deploy and manage web apps</li>
<li><strong>Azure Logic Apps</strong> - Design Logic Apps workflows visually</li>
<li><strong>Azure Storage</strong> - Browse and manage storage accounts</li>
<li><strong>Azure Databases</strong> - Manage SQL, Cosmos DB, PostgreSQL</li>
</ol>
<p><strong>Install all at once:</strong></p>
<p>Extensions ‚Üí Search "Azure Tools" ‚Üí Install the <strong>Azure Tools extension pack</strong> (bundles all Azure extensions)</p>
<p><strong>What this gives you:</strong><br />
- View all Azure subscriptions in VSCode sidebar<br />
- Right-click resources to perform actions (start/stop VMs, etc.)<br />
- Create Azure Functions directly in VSCode<br />
- Deploy web apps without leaving your editor<br />
- Browse storage accounts and blob containers<br />
- Query databases interactively</p>
<p><strong>Example workflow:</strong><br />
1. Write PowerShell script to query Azure Resource Graph<br />
2. View results in VSCode terminal<br />
3. Right-click VM in Azure Resources sidebar to start/stop it<br />
4. Deploy Azure Function to process the data<br />
5. All from one tool instead of switching between portal, ISE, and Visual Studio</p>
<p><strong>ISE limitation:</strong> Can only write PowerShell scripts. Can't interact with Azure resources, can't deploy Functions, no integrated Azure management.</p>
<h2>Check Your Current Module Versions</h2>
<p>Before migrating scripts, see what you have installed:</p>
<p><strong>List all Az modules:</strong></p>
<div class="codehilite"><pre><span></span><code><span class="c"># See all installed Az modules</span>
<span class="nb">Get-Module</span> <span class="n">-ListAvailable</span> <span class="n">Az</span><span class="p">.*</span>

<span class="c"># Output shows version and location</span>
<span class="n">ModuleType</span> <span class="n">Version</span>    <span class="n">Name</span>                           
<span class="p">----------</span> <span class="p">-------</span>    <span class="p">----</span>                           
<span class="n">Script</span>     <span class="n">11</span><span class="p">.</span><span class="n">2</span><span class="p">.</span><span class="n">0</span>     <span class="n">Az</span><span class="p">.</span><span class="n">Accounts</span>                    
<span class="n">Script</span>     <span class="n">7</span><span class="p">.</span><span class="n">1</span><span class="p">.</span><span class="n">0</span>      <span class="n">Az</span><span class="p">.</span><span class="n">Compute</span>                     
<span class="n">Script</span>     <span class="n">2</span><span class="p">.</span><span class="n">1</span><span class="p">.</span><span class="n">0</span>      <span class="n">Az</span><span class="p">.</span><span class="n">ResourceGraph</span>               
</code></pre></div>

<p><strong>Check specific module version:</strong></p>
<div class="codehilite"><pre><span></span><code><span class="c"># Check Az.ResourceGraph version (needed for our tag query examples)</span>
<span class="nb">Get-InstalledModule</span> <span class="n">Az</span><span class="p">.</span><span class="n">ResourceGraph</span>

<span class="n">Version</span>    <span class="n">Name</span>               <span class="n">Repository</span>
<span class="p">-------</span>    <span class="p">----</span>               <span class="p">----------</span>
<span class="n">2</span><span class="p">.</span><span class="n">1</span><span class="p">.</span><span class="n">0</span>      <span class="n">Az</span><span class="p">.</span><span class="n">ResourceGraph</span>   <span class="n">PSGallery</span>
</code></pre></div>

<p><strong>Why this matters:</strong></p>
<p>Some Az modules require PowerShell 7 for newer versions:<br />
- Az.ResourceGraph 1.x works in PowerShell 5.1<br />
- Az.ResourceGraph 2.x requires PowerShell 7</p>
<p>If you're stuck on older module versions, check if PowerShell 7 unlocks updates:</p>
<div class="codehilite"><pre><span></span><code><span class="c"># In PowerShell 7</span>
<span class="nb">Update-Module</span> <span class="n">Az</span><span class="p">.</span><span class="n">ResourceGraph</span> <span class="n">-Force</span>

<span class="c"># Gets you latest version with bug fixes and new features</span>
</code></pre></div>

<p><strong>Find modules that need updates:</strong></p>
<div class="codehilite"><pre><span></span><code><span class="c"># List modules with available updates</span>
<span class="nb">Get-InstalledModule</span> <span class="p">|</span> <span class="k">ForEach</span><span class="n">-Object</span> <span class="p">{</span>
    <span class="nv">$latest</span> <span class="p">=</span> <span class="nb">Find-Module</span> <span class="nv">$_</span><span class="p">.</span><span class="n">Name</span> <span class="n">-ErrorAction</span> <span class="n">SilentlyContinue</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">$latest</span><span class="p">.</span><span class="n">Version</span> <span class="o">-gt</span> <span class="nv">$_</span><span class="p">.</span><span class="n">Version</span><span class="p">)</span> <span class="p">{</span>
        <span class="no">[PSCustomObject]</span><span class="p">@{</span>
            <span class="n">Name</span> <span class="p">=</span> <span class="nv">$_</span><span class="p">.</span><span class="n">Name</span>
            <span class="n">Installed</span> <span class="p">=</span> <span class="nv">$_</span><span class="p">.</span><span class="n">Version</span>
            <span class="n">Available</span> <span class="p">=</span> <span class="nv">$latest</span><span class="p">.</span><span class="n">Version</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<p><strong>PowerShell 5.1 limitation:</strong> May not be able to update to latest module versions even if they exist. PowerShell 7 removes this constraint.</p>
<h2>Migration Strategy</h2>
<p><strong>Phase 1: Assessment (1 week)</strong><br />
- Inventory your existing PowerShell scripts<br />
- Test them in PowerShell 7 (use VSCode or Cloud Shell)<br />
- Document which scripts break and why</p>
<p><strong>Phase 2: Workstation setup (1 day)</strong><br />
- Install PowerShell 7 on your workstation<br />
- Install VSCode + PowerShell extension<br />
- Configure VSCode to use PowerShell 7 by default</p>
<p><strong>Phase 3: Fix high-value scripts (2-4 weeks)</strong><br />
- Start with most-used scripts<br />
- Update syntax for PowerShell 7 compatibility<br />
- Add parallel processing where it helps<br />
- Test thoroughly before production use</p>
<p><strong>Phase 4: New script standards (ongoing)</strong><br />
- Write all new scripts in PowerShell 7<br />
- Use VSCode for all PowerShell work<br />
- Document PowerShell 7 as team standard</p>
<h2>Why Microsoft Won't Force This</h2>
<p><strong>Breaking changes matter.</strong> If Microsoft:<br />
- Replaced PowerShell 5.1 with 7 as Windows default<br />
- Removed ISE from Windows<br />
- Required PowerShell 7 for Az modules</p>
<p>Result: Thousands of corporate PowerShell scripts would break instantly. Help desks would be overwhelmed.</p>
<p><strong>Their strategy:</strong> Ship both versions, let admins migrate on their timeline.</p>
<p><strong>The gap:</strong> No clear forcing function. ISE works "well enough" until it doesn't. Then you're debugging instead of automating.</p>
<h2>Bottom Line</h2>
<p>Your Windows admin workstation ships with PowerShell 5.1 and ISE. Modern Azure automation increasingly requires PowerShell 7. This creates a compatibility gap Microsoft won't force you to solve.</p>
<p><strong>If you manage Azure from a workstation, you need:</strong><br />
- PowerShell 7 installed on that workstation<br />
- VSCode instead of ISE<br />
- Understanding of when server PowerShell version matters (rarely) vs workstation version (constantly)</p>
<p><strong>The transition:</strong><br />
- Install PowerShell 7: 5 minutes<br />
- Install VSCode: 10 minutes<br />
- Test existing scripts: 30 minutes<br />
- Start using VSCode for new work: Immediate</p>
<p><strong>Or:</strong> Keep using ISE with PowerShell 5.1 until you hit errors that don't exist in PowerShell 7. Your call.</p>
<p><strong>Resources:</strong><br />
- <a href="https://learn.microsoft.com/en-us/powershell/scripting/install/installing-powershell-on-windows">PowerShell 7 installation</a><br />
- <a href="https://marketplace.visualstudio.com/items?itemName=ms-vscode.PowerShell">VSCode PowerShell extension</a><br />
- <a href="https://shell.azure.com">Azure Cloud Shell</a> (PowerShell 7, no installation needed)<br />
- <a href="https://azure-noob.com/blog/azure-vm-automation-dependency-hell/">My VM automation post</a> (related dependency issues)</p>
<hr />
<p><strong>Tested on:</strong> Windows 11 Enterprise (corporate Citrix VDI), Azure Virtual Desktop, Windows 10 Pro (physical workstation). Azure Az PowerShell modules 11.x. September-October 2025.</p>
  </div>

  
  
  <aside class="related-posts">
    <h3>Related Posts</h3>
    <ul>
      
      <li>
        <a href="../azure-vm-automation-dependency-hell/index.html">
          <span class="related-title">Why Your Automation Fails on Fresh Azure VMs (And How I Fixed It)</span>
          <span class="related-meta">2025-09-29</span>
        </a>
      </li>
      
      <li>
        <a href="../kql-cheat-sheet-complete/index.html">
          <span class="related-title">KQL Cheat Sheet for Azure Admins: Complete Resource Graph Guide</span>
          <span class="related-meta">2025-01-15</span>
        </a>
      </li>
      
      <li>
        <a href="../azure-debugging-ai-rule/index.html">
          <span class="related-title">The New Azure Debugging Rule: When AI Says &#39;I Don&#39;t Know&#39;</span>
          <span class="related-meta">2025-10-06</span>
        </a>
      </li>
      
    </ul>
  </aside>
  

  
  <nav class="post-nav">
    
      <a href="../onenote-azure-admin-tool/index.html">‚Üê OneNote: The Azure Admin Tool Nobody Tells You About</a>
    
    
      <a href="../azure-ipam-tool/index.html">IP Address Management for Azure Subscription Consolidation - What Nobody Tells You About Cloud Mergers ‚Üí</a>
    
  </nav>

</article>

    </div>
  </main>

  <!-- EMAIL CAPTURE -->
  <section class="email-signup">
    <div class="wrap">
      <div class="email-box">
        <h3>Get Azure tips in your inbox</h3>
        <p>Join Azure pros getting practical KQL queries, cost optimization tips, and real-world solutions.</p>
        <script async data-uid="3dfad5c743" src="https://azure-noob.kit.com/3dfad5c743/index.js"></script>
      </div>
    </div>
  </section>

  <footer class="site-footer">
    <div class="wrap">
      <p>&copy; 2025 Azure Noob ‚Äî Don&#39;t be a Noob</p>
    </div>
  </footer>

  <!-- Copy code functionality -->
  <script src="../../static/copy-code.js"></script>
  <!-- Quest JS (SFX toggle, embers, typewriter) -->
</body>
</html>