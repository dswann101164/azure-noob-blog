<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  
  

  <!-- Primary SEO -->
  <title>Azure Cost Optimization What Actually Works ¬∑ Azure Noob</title>
  <meta name="description" content="Ôªø--- title: &#34;Azure Cost Optimization: What Actually Works (Not Azure Advisor Recommendations)&#34; date: 2025-12-08 summary: &#34;Azure Advisor says &#39;right-size...">
  
  <link rel="canonical" href="https://azure-noob.com/blog/azure-cost-optimization-what-actually-works" />

  <!-- Favicons -->
  <link rel="icon" href="/static/images/logo.png">

  <!-- Open Graph -->
  <meta property="og:title" content="Azure Cost Optimization What Actually Works">
  <meta property="og:description" content="Ôªø--- title: &#34;Azure Cost Optimization: What Actually Works (Not Azure Advisor Recommendations)&#34; date: 2025-12-08 summary: &#34;Azure Advisor says &#39;right-size...">
  <meta property="og:type" content="article">
  <meta property="og:url" content="https://azure-noob.com/blog/azure-cost-optimization-what-actually-works">
  <meta property="og:image" content="https://azure-noob.com/static/images/hero/cloud-wars.png">

  
    <meta property="article:published_time" content="2025-12-08T00:00:00+00:00">
    <meta property="article:modified_time" content="2025-12-08T00:00:00+00:00">
    <meta property="article:author" content="David Swann">
    
  

  <!-- Twitter -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="Azure Cost Optimization What Actually Works">
  <meta name="twitter:description" content="Ôªø--- title: &#34;Azure Cost Optimization: What Actually Works (Not Azure Advisor Recommendations)&#34; date: 2025-12-08 summary: &#34;Azure Advisor says &#39;right-size...">
  <meta name="twitter:image" content="https://azure-noob.com/static/images/hero/cloud-wars.png">

  <!-- Styles -->
  <link rel="stylesheet" href="/static/styles.css">

  <!-- RSS Feed -->
  <link rel="alternate" type="application/rss+xml" title="Azure Noob RSS Feed" href="https://azure-noob.com/rss.xml">

  <!-- Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-ZNHGEB0BNZ"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-ZNHGEB0BNZ');
  </script>
</head>
<body>
  <header class="site-header">
    <div class="wrap nav-wrap">
      <div class="brand-block">
        <a href="/" class="brand-link">
          <img src="/static/images/logo.png" alt="Azure Noob logo" class="logo">
        </a>
        <span class="brand-text">
          <small>Official Website of</small>
          <strong>Azure Noob</strong>
        </span>
      </div>
      <nav class="nav">
        <a href="/">Home</a>
        <a href="/blog/">Blog</a>
        <a href="/hubs/" style="font-weight: 700;">Content Hubs</a>
        <a href="/products" style="font-weight: 700; color: #ff6b6b;">Products</a>
        <a href="/start-here">Start Here</a>
        <a href="/blog/starter-kit/">Starter Kit</a>
        <a href="/about">About</a>
        <a href="/tags/">Tags</a>
        <a href="https://github.com/dswann101164" target="_blank" rel="noopener">GitHub</a>
        <a href="/search">Search</a>
      </nav>
    </div>
  </header>

  <main class="site-content">
    <div class="wrap">
      


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Azure Cost Optimization What Actually Works",
  "description": "Ôªø--- title: &#34;Azure Cost Optimization: What Actually Works (Not Azure Advisor Recommendations)&#34; date: 2025-12-08 summary: &#34;Azure Advisor says &#39;right-size...",
  "image": {
    "@type": "ImageObject",
    "url": "https://azure-noob.com/static/images/hero/cloud-wars.png",
    "width": 1200,
    "height": 630
  },
  "author": {
    "@type": "Person",
    "name": "David Swann",
    "url": "https://azure-noob.com/about/",
    "description": "Azure Architect specializing in enterprise cloud infrastructure",
    "jobTitle": "Azure Architect",
    "worksFor": {
      "@type": "Organization",
      "name": "Synovus"
    }
  },
  "publisher": {
    "@type": "Organization",
    "name": "Azure Noob",
    "url": "https://azure-noob.com",
    "logo": {
      "@type": "ImageObject",
      "url": "https://azure-noob.com/static/images/logo.png"
    }
  },
  "datePublished": "2025-12-08T00:00:00+00:00",
  "dateModified": "2025-12-08T00:00:00+00:00",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://azure-noob.com/blog/azure-cost-optimization-what-actually-works"
  },
  "keywords": "",
  "articleSection": "Azure",
  "wordCount": "3203",
  "timeRequired": "PT16M",
  "inLanguage": "en-US",
  "isAccessibleForFree": "True",
  "about": {
    "@type": "Thing",
    "name": "Microsoft Azure"
  }
}
</script>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position": 1,
      "name": "Home",
      "item": "https://azure-noob.com"
    },
    {
      "@type": "ListItem",
      "position": 2,
      "name": "Blog",
      "item": "https://azure-noob.com/blog/"
    },
    {
      "@type": "ListItem",
      "position": 3,
      "name": "Azure Cost Optimization What Actually Works",
      "item": "https://azure-noob.com/blog/azure-cost-optimization-what-actually-works"
    }
  ]
}
</script>







<article class="post">

  
  

  <header class="post-header">
    <h1>Azure Cost Optimization What Actually Works</h1>
    <p class="muted">
      2025-12-08 ¬∑ ~16 min read
      
    </p>
    
    
    
    
  </header>

  
  <p class="post-actions" style="margin:.5rem 0 0; text-align: center;">
    <button class="btn"
            onclick="window.print(); return false;"
            title="Print this page"
            aria-label="Print this page"
            style="cursor: pointer; background: none; border: 2px solid var(--azure-blue);">
      üñ®Ô∏è Print this page
    </button>
  </p>

  
  <div class="post-body">
    <p>Ôªø---<br />
title: "Azure Cost Optimization: What Actually Works (Not Azure Advisor Recommendations)"<br />
date: 2025-12-08<br />
summary: "Azure Advisor says 'right-size your VMs.' Finance says 'why is our cloud bill still increasing?' Here's what actually reduces Azure costs in production: the tactics that work when reserved instances and Advisor recommendations aren't enough."<br />
tags: ["azure", "Cost Optimization", "FinOps", "Cost Management", "Azure Advisor", "governance"]<br />
cover: "/static/images/hero/azure-cost-optimization-complete-guide.png"<br />
hub: "finops"<br />
related_posts:<br />
  - azure-cost-reports-business-reality<br />
  - azure-openai-pricing-real-costs<br />
  - azure-chargeback-tags-model<br />
  - tag-governance-247-variations</p>
<hr />
<h1>Azure Cost Optimization: What Actually Works (Not Azure Advisor Recommendations)</h1>
<h2>The Problem</h2>
<p>Finance email at 8 AM: "Azure spend is up $47,000 this month. What are we doing about cost optimization?"</p>
<p>You open Azure Advisor. It says:<br />
- "Right-size 3 underutilized VMs" (saves $240/month)<br />
- "Delete 2 unattached disks" (saves $45/month)<br />
- "Buy reserved instances" (saves $1,200/month)</p>
<p>You implement all of it. Next month: <strong>Azure spend is still up $46,715.</strong></p>
<p><strong>Why?</strong> Because Azure Advisor optimizes what you already have. It doesn't prevent the three things that actually drive cloud cost growth:</p>
<ol>
<li><strong>Untracked resource sprawl</strong> (departments spinning up resources with no visibility)</li>
<li><strong>Lack of cost allocation</strong> (nobody knows who's spending what)</li>
<li><strong>Missing governance</strong> (no automated controls to prevent waste)</li>
</ol>
<p>Here's what actually works when Advisor recommendations aren't enough.</p>
<hr />
<h2>What Microsoft Says About Cost Optimization</h2>
<p>Microsoft's <a href="https://learn.microsoft.com/en-us/azure/cost-management-billing/">Azure Cost Management documentation</a> focuses on:</p>
<p><strong>Visibility:</strong><br />
- Cost analysis dashboards<br />
- Budget alerts<br />
- Export cost data</p>
<p><strong>Optimization:</strong><br />
- Azure Advisor recommendations<br />
- Reserved instances and savings plans<br />
- Right-sizing VMs</p>
<p><strong>Governance:</strong><br />
- Azure Policy for tagging<br />
- Budgets and alerts</p>
<p>These tools are excellent for <strong>measuring</strong> and <strong>reacting</strong> to costs. They don't <strong>prevent</strong> the costs from happening in the first place.</p>
<p><strong>Example:</strong> Azure Advisor tells you a VM has been idle for 30 days. Great! But why did it get created in the first place? Who approved it? What application needed it? When Advisor finds it idle, you've already spent $2,000 on something nobody uses.</p>
<p><strong>The gap:</strong> Microsoft's cost tools assume you have governance in place. Most organizations don't.</p>
<p>Here's what to do BEFORE you even look at Advisor recommendations.</p>
<hr />
<h2>The 3 Phases of Azure Cost Optimization</h2>
<h3><strong>Phase 1: Know What You Have (Month 1)</strong></h3>
<h3><strong>Phase 2: Know Who's Spending It (Month 2-3)</strong></h3>
<h3><strong>Phase 3: Prevent Waste Automatically (Month 4+)</strong></h3>
<p>Most organizations skip Phase 1 and 2 and jump straight to Phase 3 (buying reserved instances). Then they wonder why costs keep growing.</p>
<p>Let's fix that.</p>
<hr />
<h2>Phase 1: Know What You Have</h2>
<p><strong>Time investment:</strong> 2-4 weeks<br />
<strong>Cost impact:</strong> Identifies 20-30% of resources that shouldn't exist</p>
<h3>The Problem</h3>
<p>You can't optimize what you can't see. Azure Cost Management shows you <strong>costs</strong>. It doesn't show you:<br />
- Which resources support which applications<br />
- Who requested each resource<br />
- Why resources were created<br />
- Which resources are actually being used</p>
<p><strong>Real example:</strong> Found 47 VMs running in a subscription. Only 12 had been accessed in the last 90 days. <strong>Total waste:</strong> $22,000/month.</p>
<p><strong>Why it happened:</strong> Developers spin up test VMs, forget about them, move to new projects. No process to track or decommission them.</p>
<h3>What Actually Works: Resource Inventory with Business Context</h3>
<p><strong>Step 1: Build the inventory KQL query</strong></p>
<div class="codehilite"><pre><span></span><code><span class="n">Resources</span>
<span class="p">|</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="p">=~</span><span class="w"> </span><span class="s">&#39;microsoft.compute/virtualmachines&#39;</span>
<span class="p">|</span><span class="w"> </span><span class="k">extend</span><span class="w"> </span>
<span class="w">    </span><span class="n">vmSize</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">properties</span><span class="err">.</span><span class="n">hardwareProfile</span><span class="err">.</span><span class="n">vmSize</span><span class="p">,</span>
<span class="w">    </span><span class="n">osType</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">properties</span><span class="err">.</span><span class="n">storageProfile</span><span class="err">.</span><span class="n">osDisk</span><span class="err">.</span><span class="n">osType</span><span class="p">,</span>
<span class="w">    </span><span class="n">powerState</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">properties</span><span class="err">.</span><span class="n">extended</span><span class="err">.</span><span class="n">instanceView</span><span class="err">.</span><span class="n">powerState</span><span class="err">.</span><span class="n">code</span>
<span class="p">|</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">kind</span><span class="p">=</span><span class="n">leftouter</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="n">ResourceContainers</span>
<span class="w">    </span><span class="p">|</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="s">&#39;microsoft.resources/subscriptions&#39;</span>
<span class="w">    </span><span class="p">|</span><span class="w"> </span><span class="k">project</span><span class="w"> </span><span class="n">subscriptionId</span><span class="p">,</span><span class="w"> </span><span class="n">subscriptionName</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">name</span>
<span class="p">)</span><span class="w"> </span><span class="k">on</span><span class="w"> </span><span class="n">subscriptionId</span>
<span class="p">|</span><span class="w"> </span><span class="k">project</span><span class="w"> </span>
<span class="w">    </span><span class="n">name</span><span class="p">,</span>
<span class="w">    </span><span class="n">resourceGroup</span><span class="p">,</span>
<span class="w">    </span><span class="n">subscriptionName</span><span class="p">,</span>
<span class="w">    </span><span class="n">location</span><span class="p">,</span>
<span class="w">    </span><span class="n">vmSize</span><span class="p">,</span>
<span class="w">    </span><span class="n">osType</span><span class="p">,</span>
<span class="w">    </span><span class="n">powerState</span><span class="p">,</span>
<span class="w">    </span><span class="n">tags</span><span class="p">,</span>
<span class="w">    </span><span class="n">id</span>
<span class="p">|</span><span class="w"> </span><span class="k">extend</span><span class="w"> </span>
<span class="w">    </span><span class="n">Application</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">tostring</span><span class="p">(</span><span class="n">tags</span><span class="err">.</span><span class="n">Application</span><span class="p">),</span>
<span class="w">    </span><span class="n">Owner</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">tostring</span><span class="p">(</span><span class="n">tags</span><span class="err">.</span><span class="n">Owner</span><span class="p">),</span>
<span class="w">    </span><span class="n">CostCenter</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">tostring</span><span class="p">(</span><span class="n">tags</span><span class="err">.</span><span class="n">CostCenter</span><span class="p">),</span>
<span class="w">    </span><span class="n">Environment</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">tostring</span><span class="p">(</span><span class="n">tags</span><span class="err">.</span><span class="n">Environment</span><span class="p">)</span>
</code></pre></div>

<p><strong>This query shows:</strong><br />
- VM name, size, location<br />
- Power state (running/stopped)<br />
- Business context from tags</p>
<p><strong>Step 2: Export to Excel, add these columns manually:</strong><br />
- <strong>Last Accessed:</strong> When was this VM last logged into?<br />
- <strong>Purpose:</strong> What does this VM do?<br />
- <strong>Application Owner:</strong> Who approved this?<br />
- <strong>Decommission Date:</strong> When can we delete it?</p>
<p><strong>Step 3: Meet with each application owner</strong></p>
<p>Don't send an email survey. <strong>Schedule 15-minute meetings.</strong> Go through each resource in their resource group. Ask:<br />
- "Do you still need this?"<br />
- "When was the last time anyone logged into it?"<br />
- "What happens if we turn it off for a week?"</p>
<p><strong>Result from one organization:</strong> 35% of VMs were "probably safe to delete" after these conversations.</p>
<h3>What to Do With the Results</h3>
<p><strong>Immediate actions (Week 1-2):</strong><br />
- Delete obviously unused resources (unattached disks, old snapshots, stopped VMs older than 90 days)<br />
- <strong>Savings:</strong> Usually 5-10% of monthly spend</p>
<p><strong>Short-term actions (Week 3-4):</strong><br />
- Schedule decommission dates for "probably safe to delete" resources<br />
- Test shutdowns (turn off for 1 week, see if anyone complains)<br />
- <strong>Savings:</strong> 15-20% of monthly spend</p>
<p><strong>Long-term actions (Month 2+):</strong><br />
- Implement automated shutdown schedules (dev/test VMs off nights/weekends)<br />
- Tag enforcement (can't create resources without Owner/CostCenter tags)<br />
- <strong>Savings:</strong> 20-30% of monthly spend</p>
<hr />
<h2>Phase 2: Know Who's Spending It</h2>
<p><strong>Time investment:</strong> 4-8 weeks<br />
<strong>Cost impact:</strong> Enables chargeback, creates accountability</p>
<h3>The Problem</h3>
<p>Azure subscriptions aren't cost centers. Applications are.</p>
<p><strong>Scenario:</strong> Finance asks "How much did the Payroll application cost us this month?"</p>
<p><strong>Azure Cost Management shows:</strong> "Subscription XYZ cost $47,000."</p>
<p><strong>Finance:</strong> "But three applications run in that subscription. How much was Payroll specifically?"</p>
<p><strong>You:</strong> "Uh..."</p>
<p><strong>The gap:</strong> Azure tracks costs by subscription, resource group, and tags. Applications span all three.</p>
<h3>What Actually Works: Tag-Based Cost Allocation</h3>
<p><strong>Step 1: Define your cost allocation model</strong></p>
<p><strong>Option A: Chargeback (precise)</strong><br />
- Every dollar allocated to a business unit<br />
- Requires: Owner, CostCenter, Application tags on ALL resources<br />
- Use case: Regulated industries, large enterprises, anywhere finance requires exact allocation</p>
<p><strong>Option B: Showback (approximate)</strong><br />
- Show departments what they're spending<br />
- Doesn't require perfect tagging<br />
- Use case: Most organizations, especially early in cloud journey</p>
<p><strong>Start with showback. Move to chargeback later.</strong></p>
<p><strong>Step 2: Implement tag governance</strong></p>
<p>Use Azure Policy to require tags on new resources:</p>
<div class="codehilite"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;mode&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Indexed&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;policyRule&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;if&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;allOf&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">          </span><span class="nt">&quot;field&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;type&quot;</span><span class="p">,</span>
<span class="w">          </span><span class="nt">&quot;equals&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Microsoft.Compute/virtualMachines&quot;</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">          </span><span class="nt">&quot;anyOf&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">            </span><span class="p">{</span>
<span class="w">              </span><span class="nt">&quot;field&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;tags[&#39;CostCenter&#39;]&quot;</span><span class="p">,</span>
<span class="w">              </span><span class="nt">&quot;exists&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;false&quot;</span>
<span class="w">            </span><span class="p">},</span>
<span class="w">            </span><span class="p">{</span>
<span class="w">              </span><span class="nt">&quot;field&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;tags[&#39;Owner&#39;]&quot;</span><span class="p">,</span>
<span class="w">              </span><span class="nt">&quot;exists&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;false&quot;</span>
<span class="w">            </span><span class="p">},</span>
<span class="w">            </span><span class="p">{</span>
<span class="w">              </span><span class="nt">&quot;field&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;tags[&#39;Application&#39;]&quot;</span><span class="p">,</span>
<span class="w">              </span><span class="nt">&quot;exists&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;false&quot;</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">          </span><span class="p">]</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">      </span><span class="p">]</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;then&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;effect&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;deny&quot;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<p><strong>This policy blocks VM creation unless CostCenter, Owner, and Application tags are present.</strong></p>
<p><strong>Critical:</strong> Start with "audit" effect, not "deny". Give teams 30 days to fix existing resources before you block new ones.</p>
<p><strong>Step 3: Build cost allocation reports in Power BI</strong></p>
<p>Azure Cost Management exports cost data. Connect Power BI to it:</p>
<div class="codehilite"><pre><span></span><code>CostByApplication = 
<span class="nf">CALCULATE</span><span class="p">(</span>
<span class="w">    </span><span class="nf">SUM</span><span class="p">(</span><span class="na">&#39;CostData&#39;[Cost]</span><span class="p">),</span>
<span class="w">    </span><span class="nf">ALLEXCEPT</span><span class="p">(</span><span class="na">&#39;CostData&#39;</span><span class="p">,</span><span class="w"> </span><span class="na">&#39;CostData&#39;[Application]</span><span class="p">)</span>
<span class="p">)</span>
</code></pre></div>

<p><strong>Report shows:</strong><br />
- Cost by Application<br />
- Cost by CostCenter<br />
- Cost by Owner<br />
- Drill-down to resource-level details</p>
<p><strong>Result:</strong> Finance can now answer "How much did Payroll cost?" with real data.</p>
<h3>What to Do With the Results</h3>
<p><strong>Immediate actions (Month 1):</strong><br />
- Publish cost by application reports monthly<br />
- Send to application owners<br />
- <strong>Impact:</strong> Creates awareness (costs usually stabilize or decrease 5-10%)</p>
<p><strong>Short-term actions (Month 2-3):</strong><br />
- Implement budgets per application<br />
- Alert owners when they're at 80% of budget<br />
- <strong>Impact:</strong> Prevents surprise overruns</p>
<p><strong>Long-term actions (Month 4+):</strong><br />
- Chargeback model (IT charges business units for Azure spend)<br />
- Application owners now have incentive to optimize<br />
- <strong>Impact:</strong> 10-20% cost reduction as owners optimize their own resources</p>
<hr />
<h2>Phase 3: Prevent Waste Automatically</h2>
<p><strong>Time investment:</strong> Ongoing<br />
<strong>Cost impact:</strong> Prevents 30-40% of future waste</p>
<h3>The Problem</h3>
<p>Even with perfect visibility and cost allocation, costs still grow because:<br />
- Developers forget to delete test resources<br />
- VMs run 24/7 when they're only needed 8-5<br />
- Storage accounts accumulate old data nobody needs<br />
- Nobody notices small resource creep (5 VMs here, 3 storage accounts there)</p>
<p><strong>Manual optimization doesn't scale.</strong> You need automation.</p>
<h3>What Actually Works: Automated Governance</h3>
<p><strong>Tactic 1: Auto-shutdown schedules</strong></p>
<p>Dev/test VMs should not run nights and weekends.</p>
<p><strong>PowerShell automation:</strong></p>
<div class="codehilite"><pre><span></span><code><span class="c"># Tag VMs with shutdown schedule</span>
<span class="nb">Update-AzTag</span> <span class="n">-ResourceId</span> <span class="nv">$vmId</span> <span class="n">-Tag</span> <span class="p">@{</span>
    <span class="s2">&quot;AutoShutdown&quot;</span> <span class="p">=</span> <span class="s2">&quot;Weeknights-7PM&quot;</span>
    <span class="s2">&quot;AutoStart&quot;</span> <span class="p">=</span> <span class="s2">&quot;Weekdays-7AM&quot;</span>
<span class="p">}</span> <span class="n">-Operation</span> <span class="n">Merge</span>

<span class="c"># Azure Automation runbook checks tags hourly, starts/stops VMs</span>
</code></pre></div>

<p><strong>Savings:</strong> 65% reduction in dev/test VM costs (VMs only run 40 hours/week instead of 168)</p>
<p><strong>Tactic 2: Storage lifecycle policies</strong></p>
<p>Old blobs cost money. Delete them automatically.</p>
<p><strong>Lifecycle policy:</strong></p>
<div class="codehilite"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;rules&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;enabled&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;delete-old-logs&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Lifecycle&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;definition&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;filters&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="nt">&quot;blobTypes&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;blockBlob&quot;</span><span class="p">],</span>
<span class="w">          </span><span class="nt">&quot;prefixMatch&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;logs/&quot;</span><span class="p">]</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="nt">&quot;actions&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="nt">&quot;baseBlob&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;delete&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">              </span><span class="nt">&quot;daysAfterModificationGreaterThan&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">90</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">          </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">]</span>
<span class="p">}</span>
</code></pre></div>

<p><strong>Savings:</strong> 30-50% reduction in storage costs (depends on data retention needs)</p>
<p><strong>Tactic 3: Orphaned resource cleanup</strong></p>
<p>Unattached disks, unused NICs, old snapshots√É¬¢√¢‚Äö¬¨√¢‚Ç¨¬ùnobody notices them until the bill arrives.</p>
<p><strong>KQL query to find orphaned disks:</strong></p>
<div class="codehilite"><pre><span></span><code><span class="n">Resources</span>
<span class="p">|</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="p">=~</span><span class="w"> </span><span class="s">&#39;microsoft.compute/disks&#39;</span>
<span class="p">|</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">properties</span><span class="err">.</span><span class="n">diskState</span><span class="w"> </span><span class="p">=~</span><span class="w"> </span><span class="s">&#39;Unattached&#39;</span>
<span class="p">|</span><span class="w"> </span><span class="k">extend</span><span class="w"> </span><span class="n">diskSizeGB</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">properties</span><span class="err">.</span><span class="n">diskSizeGB</span>
<span class="p">|</span><span class="w"> </span><span class="k">extend</span><span class="w"> </span><span class="n">sku</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">properties</span><span class="err">.</span><span class="n">sku</span><span class="err">.</span><span class="n">name</span>
<span class="p">|</span><span class="w"> </span><span class="k">project</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">resourceGroup</span><span class="p">,</span><span class="w"> </span><span class="n">diskSizeGB</span><span class="p">,</span><span class="w"> </span><span class="n">sku</span><span class="p">,</span><span class="w"> </span><span class="n">id</span>
</code></pre></div>

<p><strong>Automate cleanup:</strong> Azure Automation runbook deletes unattached disks older than 30 days (after confirming with owners).</p>
<p><strong>Savings:</strong> $5-10K/month in mid-size environments</p>
<p><strong>Tactic 4: Right-sizing automation</strong></p>
<p>Azure Advisor says "right-size this VM." Great. Who's actually going to do it?</p>
<p><strong>Automation pattern:</strong><br />
1. Weekly script pulls Advisor recommendations<br />
2. Filters for high-confidence, low-risk changes (CPU &lt;5% for 30 days)<br />
3. Creates Azure DevOps ticket for VM owner<br />
4. Auto-applies change if owner doesn't respond in 14 days</p>
<p><strong>Savings:</strong> Actually implements 80% of Advisor recommendations (vs. 10% manual implementation rate)</p>
<h3>What to Do With the Results</h3>
<p><strong>Month 1:</strong><br />
- Implement auto-shutdown for dev/test VMs<br />
- <strong>Impact:</strong> 15-25% reduction in VM costs</p>
<p><strong>Month 2:</strong><br />
- Add storage lifecycle policies<br />
- <strong>Impact:</strong> 10-20% reduction in storage costs</p>
<p><strong>Month 3:</strong><br />
- Automate orphaned resource cleanup<br />
- <strong>Impact:</strong> $5-15K/month in small waste elimination</p>
<p><strong>Month 4+:</strong><br />
- Automate Advisor recommendation implementation<br />
- <strong>Impact:</strong> Another 10-15% reduction from right-sizing</p>
<p><strong>Cumulative:</strong> 30-40% reduction in Azure spend with minimal ongoing effort</p>
<hr />
<h2>The Tools You Actually Need</h2>
<p><strong>Forget expensive third-party cost optimization tools.</strong> Here's what you need:</p>
<h3><strong>1. Azure Resource Graph (Free)</strong></h3>
<p>For inventory and resource discovery</p>
<p><strong>Learn more:</strong> <a href="/blog/kql-cheat-sheet-complete/">KQL Cheat Sheet</a></p>
<h3><strong>2. Power BI (Free with Office 365)</strong></h3>
<p>For cost allocation reports and executive dashboards</p>
<p><strong>Learn more:</strong> <a href="/blog/azure-cost-reports-business-reality/">Azure Cost Reports for Business Reality</a></p>
<h3><strong>3. Azure Policy (Free)</strong></h3>
<p>For tag enforcement and governance</p>
<p><strong>Learn more:</strong> <a href="/blog/azure-tag-governance-policy/">Azure Tag Governance Policy</a></p>
<h3><strong>4. Azure Automation (Nearly Free)</strong></h3>
<p>For auto-shutdown, cleanup scripts, and Advisor automation</p>
<p><strong>Cost:</strong> ~$5/month for typical automation workloads</p>
<h3><strong>5. Excel + 15-Minute Meetings (Free)</strong></h3>
<p>For Phase 1 inventory and application owner conversations</p>
<p><strong>Total cost:</strong> $5/month + your time</p>
<p><strong>Compare to:</strong> Third-party tools ($10K-50K/year) that do the same thing</p>
<hr />
<h2>What Doesn't Work (Don't Waste Time)</h2>
<h3><strong>√É¬¢√Ç¬ù√Ö‚Äô Reserved Instances Without Governance</strong></h3>
<p><strong>Scenario:</strong> You buy 3-year reserved instances. Savings: 40%.</p>
<p><strong>Problem:</strong> Application gets decommissioned in Year 2. You're stuck paying for reserved capacity you don't need.</p>
<p><strong>Lesson:</strong> Only buy reserved instances for workloads with:<br />
- Stable usage patterns (proven 12+ months)<br />
- Business commitment (not getting decommissioned)<br />
- Tag governance (you can track what it's for)</p>
<h3><strong>√É¬¢√Ç¬ù√Ö‚Äô Cost Optimization Without Tag Governance</strong></h3>
<p><strong>Scenario:</strong> You optimize costs by 20%. Finance asks "Which applications saved money?"</p>
<p><strong>Problem:</strong> You can't answer because resources aren't tagged with application names.</p>
<p><strong>Lesson:</strong> Phase 2 (cost allocation) enables Phase 3 (optimization). Don't skip it.</p>
<h3><strong>√É¬¢√Ç¬ù√Ö‚Äô Relying on Advisor Recommendations Alone</strong></h3>
<p><strong>Scenario:</strong> Azure Advisor says "save $1,200/month with these 10 changes."</p>
<p><strong>Problem:</strong> 9 of those recommendations are low-risk but also low-impact. The 10th is high-risk (resize production database) and nobody wants to do it.</p>
<p><strong>Lesson:</strong> Advisor finds optimization opportunities. It doesn't implement them or assess risk. You need automation.</p>
<h3><strong>√É¬¢√Ç¬ù√Ö‚Äô Sending Email Surveys About Resource Usage</strong></h3>
<p><strong>Scenario:</strong> You email 50 application owners: "Do you still need these VMs?"</p>
<p><strong>Responses:</strong> 3 people reply. 47 ignore the email.</p>
<p><strong>Lesson:</strong> Schedule 15-minute meetings. Walk through resources together. You'll get real answers.</p>
<hr />
<h2>Real-World Results</h2>
<p><strong>Organization A (Regional financial services company):</strong><br />
- <strong>Starting point:</strong> $180K/month Azure spend, no tag governance<br />
- <strong>Phase 1 (Month 1-2):</strong> Resource inventory identified $45K/month in unused VMs<br />
- <strong>Phase 2 (Month 3-4):</strong> Tag enforcement + cost allocation reports<br />
- <strong>Phase 3 (Month 5-8):</strong> Auto-shutdown, lifecycle policies, orphaned resource cleanup<br />
- <strong>Result:</strong> $120K/month Azure spend (33% reduction), maintained for 12+ months</p>
<p><strong>Organization B (Healthcare SaaS company):</strong><br />
- <strong>Starting point:</strong> $85K/month Azure spend, growing 15%/month<br />
- <strong>Phase 1 (Month 1):</strong> Found 40% of storage was old backups nobody needed<br />
- <strong>Phase 2 (Month 2-3):</strong> Tag governance stopped untracked resource sprawl<br />
- <strong>Phase 3 (Month 4+):</strong> Auto-shutdown reduced dev/test costs by 60%<br />
- <strong>Result:</strong> $62K/month Azure spend (27% reduction), growth stopped</p>
<p><strong>Pattern:</strong> Most organizations find 20-40% optimization opportunity. Half of it comes from "delete stuff nobody's using." The other half comes from automation.</p>
<hr />
<h2>The 90-Day Cost Optimization Plan</h2>
<h3><strong>Month 1: Visibility</strong></h3>
<ul>
<li><strong>Week 1-2:</strong> Resource inventory (KQL queries, Excel export)</li>
<li><strong>Week 3-4:</strong> Application owner meetings (15 min each)</li>
<li><strong>Result:</strong> List of resources to delete, downsize, or keep</li>
</ul>
<h3><strong>Month 2: Allocation</strong></h3>
<ul>
<li><strong>Week 1-2:</strong> Implement tag governance (Azure Policy with "audit" effect)</li>
<li><strong>Week 3-4:</strong> Build Power BI cost allocation reports</li>
<li><strong>Result:</strong> Finance can answer "How much did Application X cost?"</li>
</ul>
<h3><strong>Month 3: Automation</strong></h3>
<ul>
<li><strong>Week 1:</strong> Auto-shutdown for dev/test VMs</li>
<li><strong>Week 2:</strong> Storage lifecycle policies</li>
<li><strong>Week 3:</strong> Orphaned resource cleanup automation</li>
<li><strong>Week 4:</strong> Advisor recommendation automation</li>
<li><strong>Result:</strong> Ongoing waste prevention without manual effort</li>
</ul>
<p><strong>Expected outcome:</strong> 25-35% cost reduction, sustained indefinitely</p>
<hr />
<h2>Common Objections (And Responses)</h2>
<h3><strong>"We don't have time for 15-minute meetings with every app owner."</strong></h3>
<p>You don't have time NOT to. One meeting prevents $2,000/month in waste. That's $24,000/year. Worth 15 minutes?</p>
<h3><strong>"Our developers will complain about auto-shutdown breaking their workflows."</strong></h3>
<p>Give them an opt-out tag. <code>"AutoShutdown" = "Never"</code> for resources that need 24/7 uptime. 95% of dev/test VMs don't need it.</p>
<h3><strong>"We tried tag governance before. Nobody followed it."</strong></h3>
<p>Because you didn't enforce it. Move from "audit" to "deny" policy. Can't create resources without tags.</p>
<h3><strong>"Reserved instances are too risky. What if the workload changes?"</strong></h3>
<p>Then don't buy 3-year commitments. Buy 1-year. Or use savings plans (more flexible). Or just optimize with automation first.</p>
<h3><strong>"Our organization is too complex for this simple approach."</strong></h3>
<p>Your organization is exactly WHY this approach works. Simple, repeatable, automated. Complexity is the enemy of cost control.</p>
<hr />
<hr />
<h2>The Bottom Line</h2>
<p><strong>Azure Advisor recommendations are necessary but not sufficient.</strong></p>
<p><strong>What Advisor does:</strong><br />
- Finds optimization opportunities in existing resources<br />
- Recommends reserved instances and right-sizing<br />
- Identifies unused resources</p>
<p><strong>What Advisor doesn't do:</strong><br />
- Stop new waste from being created<br />
- Allocate costs to business units<br />
- Implement recommendations automatically<br />
- Prevent untracked resource sprawl</p>
<p><strong>The winning formula:</strong><br />
1. <strong>Know what you have</strong> (inventory + business context)<br />
2. <strong>Know who's spending it</strong> (tag governance + cost allocation)<br />
3. <strong>Prevent waste automatically</strong> (auto-shutdown + lifecycle policies + cleanup scripts)</p>
<p><strong>Expected result:</strong> 25-35% cost reduction, maintained indefinitely</p>
<p><strong>Time investment:</strong> 90 days upfront, minimal ongoing effort</p>
<p><strong>Tools needed:</strong> Azure Resource Graph + Power BI + Azure Policy + Azure Automation (total cost: ~$5/month)</p>
<hr />
<h2>Related Resources</h2>
<p><strong>Learn the tools for cost optimization:</strong><br />
- <a href="/blog/kql-cheat-sheet-complete/">KQL Cheat Sheet</a> - Query resources and costs<br />
- <a href="/hub/finops/">FinOps Hub</a> - Complete cost optimization guides<br />
- <a href="/blog/azure-tag-governance-policy/">Azure Tag Governance</a> - Enforce tagging for cost allocation<br />
- <a href="/blog/azure-cost-reports-business-reality/">Azure Cost Reports for Business</a> - Build Power BI dashboards</p>
<p><strong>Cost-related posts:</strong><br />
- <a href="/blog/azure-chargeback-tags-model/">Azure Chargeback Tags Model</a><br />
- <a href="/blog/azure-openai-pricing-real-costs/">Azure OpenAI Pricing Reality</a><br />
- <a href="/blog/tag-governance-247-variations/">Tag Governance: 247 Variations</a></p>
<hr />
<p><strong>Questions about cost optimization?</strong> Let me know what you're struggling with. Email or comment below.</p>
<p><em>Updated December 8, 2025</em></p>
  </div>

  
  <section class="starter-kit-callout" style="
    max-width: 800px;
    margin: 3rem auto 2rem;
    padding: 2rem;
    border-radius: 12px;
    background: var(--bg-light);
    border: 1px solid var(--border);
    text-align: left;
  ">
    <h3 style="margin-top: 0;">Azure Admin Starter Kit (Free Download)</h3>
    <p style="margin-bottom: 1rem;">
      Get my KQL cheat sheet, 50 Windows + 50 Linux commands, and an Azure RACI template in one free bundle.
    </p>
    <a href="/blog/starter-kit/" class="btn">Get the Starter Kit ‚Üí</a>
  </section>

  
  <aside class="email-capture" style="max-width: 800px; margin: 4rem auto; padding: 3rem; background: linear-gradient(135deg, #0078d4 0%, #005a9e 100%); border-radius: 12px; text-align: center; color: white;">
    <h3 style="margin-top: 0; color: white; font-size: 1.75rem;">Get Azure operational guides in your inbox</h3>
    <p style="margin: 1rem 0 2rem; font-size: 1.1rem; color: white;">Weekly tips from managing 44 Azure subscriptions. No marketing BS.</p>
    
    <form action="https://app.kit.com/forms/8896829/subscriptions" method="post" style="max-width: 500px; margin: 0 auto; display: flex; gap: 0.75rem; flex-wrap: wrap; justify-content: center;">
      <input type="email" 
             name="email_address" 
             placeholder="your@email.com" 
             required 
             style="flex: 1; min-width: 250px; padding: 0.875rem 1rem; border: none; border-radius: 8px; font-size: 1rem; color: #333;">
      <button type="submit" 
              style="padding: 0.875rem 2rem; background: white; color: #0078d4; border: none; border-radius: 8px; font-weight: 700; cursor: pointer; white-space: nowrap; font-size: 1rem; transition: all 0.2s;">
        Subscribe
      </button>
    </form>
    
    <p style="margin: 1.5rem 0 0; font-size: 0.9rem; opacity: 0.9; color: white;">
      Join 500+ Azure admins. Unsubscribe anytime.
    </p>
  </aside>

  
  

  
  
  
    <!-- CTA: General Email Capture (KIT INLINE FORM) -->
<div class="cta-block" style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); padding: 2rem; border-radius: 12px; margin: 3rem 0; text-align: center; color: white;">
  <h3 style="margin: 0 0 0.5rem; font-size: 1.5rem; color: white;">Get Azure operational guides in your inbox</h3>
  <p style="margin: 0 0 1.5rem; font-size: 1rem; line-height: 1.5; color: white;">
    Weekly tips from managing 44 Azure subscriptions. No marketing BS.
  </p>
  
  <!-- Kit inline form - no JavaScript conflicts -->
  <form action="https://app.kit.com/forms/7867186/subscriptions" method="post" style="max-width: 500px; margin: 0 auto; display: flex; gap: 0.5rem; flex-wrap: wrap; justify-content: center;">
    <input type="email" 
           name="email_address" 
           placeholder="your@email.com" 
           required 
           style="flex: 1; min-width: 250px; padding: 0.75rem 1rem; border: none; border-radius: 6px; font-size: 1rem; color: #333;">
    <button type="submit" 
            style="padding: 0.75rem 1.5rem; background: white; color: #4facfe; border: none; border-radius: 6px; font-weight: 700; cursor: pointer; white-space: nowrap; font-size: 1rem;">
      Subscribe
    </button>
  </form>
  
  <p style="margin: 1rem 0 0; font-size: 0.85rem; opacity: 0.9; color: white;">
    Join 500+ Azure admins. Unsubscribe anytime.
  </p>
</div>
  

  
  <nav class="post-nav">
    
      <a href="/blog/azure-reporting-role-microsoft-should-create">
        <span style="opacity: 0.7; font-size: 0.85rem; display: block; margin-bottom: 0.25rem;">‚Üê Previous</span>
        <strong>The Azure Role Microsoft Forgot to Certify: Why There&#39;s No Exam for Workbooks, KQL, Power BI, and AI</strong>
      </a>
    
    
      <a href="/blog/50-windows-commands-azure" style="text-align: right;">
        <span style="opacity: 0.7; font-size: 0.85rem; display: block; margin-bottom: 0.25rem;">Next ‚Üí</span>
        <strong>50 Windows Commands for Azure VMs (PowerShell + Active Directory)</strong>
      </a>
    
  </nav>

</article>

    </div>
  </main>

  <footer class="site-footer">
    <div class="wrap">
      <p>&copy; 2025 Azure Noob ‚Äî Don&#39;t be a Noob</p>
      <p style="margin-top: 0.5rem; font-size: 0.9rem;">
        <a href="/rss.xml" title="Subscribe via RSS">RSS Feed</a> ¬∑ 
        <a href="https://github.com/dswann101164" target="_blank" rel="noopener">GitHub</a>
      </p>
      <p style="margin-top: 1.5rem; font-size: 0.85rem; opacity: 0.7; font-style: italic;">
        "Trust in the Lord with all your heart, and lean not on your own understanding;<br>
        in all your ways acknowledge Him, and He will make your paths straight" ‚Äî Proverbs 3:5-6
      </p>
    </div>
  </footer>

  <!-- Copy code functionality -->
  <script src="/static/copy-code.js"></script>

  <!-- Exit-Intent Popup -->
  <div id="exit-popup" class="exit-popup" style="display: none;">
    <div class="exit-popup-content">
      <button class="exit-popup-close" onclick="closeExitPopup()">&times;</button>
      <h2>Wait! Before You Go...</h2>
      <p class="exit-popup-subtitle">Get the <strong>FREE Azure Admin Starter Kit</strong></p>
      <ul class="exit-popup-benefits">
        <li>‚úì 15 Essential KQL Queries</li>
        <li>‚úì 50 Windows Commands</li>
        <li>‚úì 50 Linux Commands</li>
      </ul>
      <form id="exit-popup-form" class="exit-popup-form">
        <input type="email" id="popup-email" placeholder="Enter your email" required>
        <button type="submit" class="exit-popup-submit">Send Me The Free Kit</button>
      </form>
      <p class="exit-popup-privacy">We'll also notify you about new tools & guides. Unsubscribe anytime.</p>
    </div>
  </div>

  <style>
  .exit-popup {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.8);
    z-index: 10000;
    display: flex;
    align-items: center;
    justify-content: center;
    animation: fadeIn 0.3s ease;
  }

  @keyframes fadeIn {
    from { opacity: 0; }
    to { opacity: 1; }
  }

  .exit-popup-content {
    background: white;
    padding: 2.5rem;
    border-radius: 12px;
    max-width: 500px;
    width: 90%;
    position: relative;
    box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
    animation: slideUp 0.3s ease;
  }

  @keyframes slideUp {
    from { transform: translateY(50px); opacity: 0; }
    to { transform: translateY(0); opacity: 1; }
  }

  .exit-popup-close {
    position: absolute;
    top: 1rem;
    right: 1rem;
    background: none;
    border: none;
    font-size: 2rem;
    cursor: pointer;
    color: #999;
    line-height: 1;
  }

  .exit-popup-close:hover {
    color: #333;
  }

  .exit-popup h2 {
    margin: 0 0 0.5rem 0;
    color: #0078d4;
    font-size: 2rem;
  }

  .exit-popup-subtitle {
    font-size: 1.2rem;
    margin: 0 0 1.5rem 0;
  }

  .exit-popup-benefits {
    list-style: none;
    padding: 0;
    margin: 1.5rem 0;
  }

  .exit-popup-benefits li {
    padding: 0.5rem 0;
    font-size: 1.1rem;
  }

  .exit-popup-form {
    margin: 1.5rem 0;
  }

  .exit-popup-form input[type="email"] {
    width: 100%;
    padding: 1rem;
    border: 2px solid #ddd;
    border-radius: 6px;
    font-size: 1rem;
    margin-bottom: 1rem;
  }

  .exit-popup-form input[type="email"]:focus {
    outline: none;
    border-color: #0078d4;
  }

  .exit-popup-submit {
    width: 100%;
    padding: 1rem 2rem;
    background: #0078d4;
    color: white;
    border: none;
    border-radius: 6px;
    font-size: 1.1rem;
    font-weight: bold;
    cursor: pointer;
    transition: background 0.2s;
  }

  .exit-popup-submit:hover {
    background: #005a9e;
  }

  .exit-popup-privacy {
    font-size: 0.85rem;
    color: #666;
    margin-top: 1rem;
    text-align: center;
  }
  </style>

  <script>
  // Exit-intent detection
  let exitPopupShown = false;
  let mouseY = 0;

  document.addEventListener('mousemove', (e) => {
    mouseY = e.clientY;
  });

  document.addEventListener('mouseout', (e) => {
    // If mouse leaves through top of viewport and popup hasn't been shown
    if (!exitPopupShown && e.clientY <= 0 && mouseY <= 100) {
      // Check if user has seen it before (session storage)
      if (!sessionStorage.getItem('exitPopupSeen')) {
        showExitPopup();
      }
    }
  });

  function showExitPopup() {
    exitPopupShown = true;
    document.getElementById('exit-popup').style.display = 'flex';
    sessionStorage.setItem('exitPopupSeen', 'true');
  }

  function closeExitPopup() {
    document.getElementById('exit-popup').style.display = 'none';
  }

  // Handle form submission
  document.getElementById('exit-popup-form').addEventListener('submit', async (e) => {
    e.preventDefault();
    const email = document.getElementById('popup-email').value;
    
    // Send to ConvertKit (we'll set this up next)
    try {
      // For now, just close and redirect
      closeExitPopup();
      
      // Track in Google Analytics
      if (typeof gtag !== 'undefined') {
        gtag('event', 'signup', {
          'event_category': 'email',
          'event_label': 'exit_popup',
          'value': email
        });
      }
      
      // Redirect to starter kit page
      window.location.href = '/blog/starter-kit/';
      
    } catch (error) {
      console.error('Error:', error);
      // Still redirect even if tracking fails
      window.location.href = '/blog/starter-kit/';
    }
  });

  // Close on background click
  document.getElementById('exit-popup').addEventListener('click', (e) => {
    if (e.target.id === 'exit-popup') {
      closeExitPopup();
    }
  });
  </script>
</body>
</html>