<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  
  

  <!-- Primary SEO -->
  <title>KQL Cheat Sheet for Azure Migration Discovery: 48 Production-Tested Queries ¬∑ Azure Noob</title>
  <meta name="description" content="Complete KQL reference for Azure Resource Graph: 15 free fundamental queries + migration discovery section. Auto-fill 25 of 55 migration questions with KQL....">
  
  <link rel="canonical" href="https://azure-noob.com/blog/kql-cheat-sheet-complete" />

  <!-- Favicons -->
  <link rel="icon" href="/static/images/logo.png">

  <!-- Open Graph -->
  <meta property="og:title" content="KQL Cheat Sheet for Azure Migration Discovery: 48 Production-Tested Queries">
  <meta property="og:description" content="Complete KQL reference for Azure Resource Graph: 15 free fundamental queries + migration discovery section. Auto-fill 25 of 55 migration questions with KQL....">
  <meta property="og:type" content="article">
  <meta property="og:url" content="https://azure-noob.com/blog/kql-cheat-sheet-complete">
  <meta property="og:image" content="https://azure-noob.com/static/images/hero/kql-cheat-sheet.png">

  
    <meta property="article:published_time" content="2025-01-15T00:00:00+00:00">
    <meta property="article:modified_time" content="2025-12-28T00:00:00+00:00">
    <meta property="article:author" content="David Swann">
    
      
        <meta property="article:tag" content="Azure">
      
        <meta property="article:tag" content="Cheat Sheet">
      
        <meta property="article:tag" content="KQL">
      
        <meta property="article:tag" content="Log Analytics">
      
        <meta property="article:tag" content="Query Language">
      
        <meta property="article:tag" content="Resource Graph">
      
    
  

  <!-- Twitter -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="KQL Cheat Sheet for Azure Migration Discovery: 48 Production-Tested Queries">
  <meta name="twitter:description" content="Complete KQL reference for Azure Resource Graph: 15 free fundamental queries + migration discovery section. Auto-fill 25 of 55 migration questions with KQL....">
  <meta name="twitter:image" content="https://azure-noob.com/static/images/hero/kql-cheat-sheet.png">

  <!-- Styles -->
  <link rel="stylesheet" href="/static/styles.css">

  <!-- RSS Feed -->
  <link rel="alternate" type="application/rss+xml" title="Azure Noob RSS Feed" href="https://azure-noob.com/rss.xml">

  <!-- Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-ZNHGEB0BNZ"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-ZNHGEB0BNZ');
  </script>
</head>
<body>
  <header class="site-header">
    <div class="wrap nav-wrap">
      <div class="brand-block">
        <a href="/" class="brand-link">
          <img src="/static/images/logo.png" alt="Azure Noob logo" class="logo">
        </a>
        <span class="brand-text">
          <small>Official Website of</small>
          <strong>Azure Noob</strong>
        </span>
      </div>
      <nav class="nav">
        <a href="/">Home</a>
        <a href="/blog/">Blog</a>
        <a href="/hubs/" style="font-weight: 700;">Content Hubs</a>
        <a href="/products" style="font-weight: 700; color: #ff6b6b;">Products</a>
        <a href="/start-here">Start Here</a>
        <a href="/blog/starter-kit/">Starter Kit</a>
        <a href="/about">About</a>
        <a href="/tags/">Tags</a>
        <a href="https://github.com/dswann101164" target="_blank" rel="noopener">GitHub</a>
        <a href="/search">Search</a>
      </nav>
    </div>
  </header>

  <main class="site-content">
    <div class="wrap">
      


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "KQL Cheat Sheet for Azure Migration Discovery: 48 Production-Tested Queries",
  "description": "Complete KQL reference for Azure Resource Graph: 15 free fundamental queries + migration discovery section. Auto-fill 25 of 55 migration questions with KQL....",
  "image": {
    "@type": "ImageObject",
    "url": "https://azure-noob.com/static/images/hero/kql-cheat-sheet.png",
    "width": 1200,
    "height": 630
  },
  "author": {
    "@type": "Person",
    "name": "David Swann",
    "url": "https://azure-noob.com/about/",
    "description": "Azure Architect specializing in enterprise cloud infrastructure",
    "jobTitle": "Azure Architect",
    "worksFor": {
      "@type": "Organization",
      "name": "Synovus"
    }
  },
  "publisher": {
    "@type": "Organization",
    "name": "Azure Noob",
    "url": "https://azure-noob.com",
    "logo": {
      "@type": "ImageObject",
      "url": "https://azure-noob.com/static/images/logo.png"
    }
  },
  "datePublished": "2025-01-15T00:00:00+00:00",
  "dateModified": "2025-12-28T00:00:00+00:00",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://azure-noob.com/blog/kql-cheat-sheet-complete"
  },
  "keywords": "Azure, Cheat Sheet, KQL, Log Analytics, Query Language, Resource Graph",
  "articleSection": "Azure",
  "wordCount": "2323",
  "timeRequired": "PT12M",
  "inLanguage": "en-US",
  "isAccessibleForFree": "True",
  "about": {
    "@type": "Thing",
    "name": "Azure"
  }
}
</script>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position": 1,
      "name": "Home",
      "item": "https://azure-noob.com"
    },
    {
      "@type": "ListItem",
      "position": 2,
      "name": "Blog",
      "item": "https://azure-noob.com/blog/"
    },
    {
      "@type": "ListItem",
      "position": 3,
      "name": "KQL Cheat Sheet for Azure Migration Discovery: 48 Production-Tested Queries",
      "item": "https://azure-noob.com/blog/kql-cheat-sheet-complete"
    }
  ]
}
</script>






<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "FAQPage",
  "mainEntity": [
    {
      "@type": "Question",
      "name": "What is KQL and why do Azure administrators need to learn it?",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "KQL (Kusto Query Language) is the query language for Azure Resource Graph, Log Analytics, Application Insights, and Microsoft Sentinel. Azure administrators need KQL to inventory resources across subscriptions, troubleshoot configuration issues, generate compliance reports, and analyze infrastructure at scale. Unlike Azure Portal's GUI which is subscription-limited, KQL queries can scan all 44+ subscriptions in seconds, join resource data with cost information, and export results for automation. No Azure certification adequately teaches operational KQL - the AZ-104 exam shows only two sample queries with zero coverage of joins, performance optimization, or production query patterns."
      }
    },
    {
      "@type": "Question",
      "name": "What is the difference between Azure Resource Graph and Log Analytics KQL?",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "Azure Resource Graph queries infrastructure metadata (resource properties, configurations, tags, locations) using the Resources and ResourceContainers tables. Log Analytics queries runtime telemetry (logs, metrics, performance data) from Azure Monitor. Resource Graph is perfect for 'what resources exist and how are they configured' questions. Log Analytics is perfect for 'what is happening right now' questions. Both use KQL syntax but query different data sources. Resource Graph is faster for infrastructure inventory (scans 31,000 resources in 2-3 seconds). Log Analytics has deeper time-series data but requires agents or diagnostic settings to collect data."
      }
    },
    {
      "@type": "Question",
      "name": "How do I query all VMs across multiple Azure subscriptions with KQL?",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "Use Azure Resource Graph Explorer with this query: Resources | where type == 'microsoft.compute/virtualmachines' | project name, location, resourceGroup, subscriptionId, properties.hardwareProfile.vmSize, properties.storageProfile.osDisk.osType | order by name asc. This scans all subscriptions you have access to (no subscription switching required), returns VM name, location, resource group, subscription, VM size, and OS type in under 3 seconds for environments with 1,000+ VMs. Add '| where subscriptionId == \"{subscription-id}\"' to filter to specific subscriptions. Add tags with '| extend environment = tostring(tags.Environment)' to include tag data."
      }
    },
    {
      "@type": "Question",
      "name": "What are the most useful KQL operators for Azure Resource Graph queries?",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "Essential KQL operators for Azure Resource Graph: (1) where - filters rows by condition, (2) project - selects specific columns to return, (3) extend - adds calculated columns without removing existing ones, (4) summarize - aggregates data with count(), sum(), avg(), (5) join - combines data from multiple tables, (6) order by - sorts results, (7) take/limit - returns top N rows, (8) distinct - returns unique values, (9) mv-expand - expands multi-value arrays into separate rows, (10) parse - extracts data from strings. Most production queries use where, project, and extend for basic inventory. Advanced queries add join for cost analysis and summarize for reporting."
      }
    },
    {
      "@type": "Question",
      "name": "How can I use KQL to find Azure resources without required tags?",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "Query untagged resources with: Resources | where tags !has 'Environment' or tags !has 'Application' or tags !has 'CostCenter' | project name, type, resourceGroup, subscriptionId, tags | order by type asc. This identifies resources missing Environment, Application, or CostCenter tags across all subscriptions. For more sophisticated tag validation, use: Resources | extend hasEnv = isnotnull(tags.Environment), hasApp = isnotnull(tags.Application), hasCost = isnotnull(tags.CostCenter) | where hasEnv == false or hasApp == false or hasCost == false | project name, type, hasEnv, hasApp, hasCost, tags. Export results to CSV for remediation tracking. This pattern is critical for FinOps chargeback models and compliance reporting."
      }
    },
    {
      "@type": "Question",
      "name": "Where should I run KQL queries for Azure infrastructure?",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "Run Azure Resource Graph KQL queries in: (1) Azure Portal Resource Graph Explorer (search 'resource-graph' in portal) - best for ad-hoc queries and testing, (2) Azure CLI with 'az graph query' command - best for automation and CI/CD pipelines, (3) PowerShell with 'Search-AzGraph' cmdlet - best for Windows automation and reporting scripts, (4) Azure Workbooks - best for interactive dashboards and scheduled reports. Resource Graph Explorer supports query history, sample queries, and keyboard shortcuts (Ctrl+Space for autocomplete). Always test queries in the portal before embedding in automation. Use query comments (// or /* */) to document complex logic for team knowledge sharing."
      }
    }
  ]
}
</script>


<article class="post">

  
  
    
    <div class="hero">
      <img src="/static/images/hero/kql-cheat-sheet.png" alt="KQL Cheat Sheet for Azure Migration Discovery: 48 Production-Tested Queries" loading="eager">
    </div>
  

  <header class="post-header">
    <h1>KQL Cheat Sheet for Azure Migration Discovery: 48 Production-Tested Queries</h1>
    <p class="muted">
      2025-01-15 ¬∑ ~12 min read
      
        ¬∑ Updated 2025-12-28
      
    </p>
    
    
    <ul class="tags-list">
      
      <li><a href="/tags/Azure" class="tag-badge">Azure</a></li>
      
      <li><a href="/tags/Cheat%20Sheet" class="tag-badge">Cheat Sheet</a></li>
      
      <li><a href="/tags/KQL" class="tag-badge">KQL</a></li>
      
      <li><a href="/tags/Log%20Analytics" class="tag-badge">Log Analytics</a></li>
      
      <li><a href="/tags/Query%20Language" class="tag-badge">Query Language</a></li>
      
      <li><a href="/tags/Resource%20Graph" class="tag-badge">Resource Graph</a></li>
      
    </ul>
    
    
    
      <p class="summary">Complete KQL reference for Azure Resource Graph: 15 free fundamental queries + migration discovery section. Auto-fill 25 of 55 migration questions with KQL. Tested on 31,000+ resources across 44 subscriptions.</p>
    
  </header>

  
  <p class="post-actions" style="margin:.5rem 0 0; text-align: center;">
    <button class="btn"
            onclick="window.print(); return false;"
            title="Print this page"
            aria-label="Print this page"
            style="cursor: pointer; background: none; border: 2px solid var(--azure-blue);">
      üñ®Ô∏è Print this page
    </button>
  </p>

  
  <div class="post-body">
    <h1>KQL Cheat Sheet: Getting Started with Azure Resource Graph</h1>
<p>This guide is part of our <a href="/hub/governance/">Azure Governance hub</a> covering policy enforcement, compliance frameworks, and enterprise controls.</p>
<blockquote>
<p><strong>Note:</strong> No Azure certification teaches KQL for operational queries. The AZ-104 exam shows you two sample queries. That's it. No Resource Graph training. No joins. No performance optimization. Nothing about the queries you'll actually write daily.</p>
<p>I wrote about this gap: <a href="/blog/azure-reporting-role-microsoft-should-create/">The Azure Role Microsoft Forgot to Certify</a>. Until Microsoft fixes this, here's the KQL guide you need.</p>
</blockquote>
<hr />
<h2>What is KQL?</h2>
<p>Kusto Query Language (KQL) is the query language for Azure Resource Graph, Log Analytics, and Microsoft Sentinel. If you manage Azure resources, you need to know KQL.</p>
<p>This cheat sheet focuses on <strong>Azure Resource Graph</strong> - querying your Azure infrastructure metadata to inventory resources, check configurations, and troubleshoot issues.</p>
<h2>Getting Started</h2>
<p><strong>Where to Run:</strong> Azure Portal &gt; Resource Graph Explorer (search "resource-graph" in the portal).</p>
<p><strong>Key Tables:</strong><br />
- <code>Resources</code>: Contains all Azure resources (VMs, NICs, disks, storage, etc.)<br />
- <code>ResourceContainers</code>: Contains subscriptions and resource groups</p>
<p><strong>Basic Query Structure:</strong> Start with a table name, pipe (<code>|</code>) to operators like <code>where</code>, <code>join</code>, or <code>project</code>.</p>
<p><strong>Example:</strong></p>
<div class="codehilite"><pre><span></span><code><span class="n">Resources</span>
<span class="p">|</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="s">&quot;microsoft.compute/virtualmachines&quot;</span>
<span class="p">|</span><span class="w"> </span><span class="k">project</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">location</span><span class="p">,</span><span class="w"> </span><span class="n">resourceGroup</span>
</code></pre></div>

<hr />
<h2>Your First 3 Queries</h2>
<h3>1. List All Your VMs</h3>
<div class="codehilite"><pre><span></span><code><span class="n">Resources</span>
<span class="p">|</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="s">&quot;microsoft.compute/virtualmachines&quot;</span>
<span class="p">|</span><span class="w"> </span><span class="k">project</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">location</span><span class="p">,</span><span class="w"> </span><span class="n">resourceGroup</span>
</code></pre></div>

<p><strong>What it does:</strong> Shows every VM across all your subscriptions.</p>
<hr />
<h3>2. Find VMs in a Specific Resource Group</h3>
<div class="codehilite"><pre><span></span><code><span class="n">Resources</span><span class="w">  </span>
<span class="p">|</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="s">&quot;microsoft.compute/virtualmachines&quot;</span>
<span class="p">|</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">resourceGroup</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="s">&quot;Production-RG&quot;</span>
<span class="p">|</span><span class="w"> </span><span class="k">project</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">location</span>
</code></pre></div>

<p><strong>What it does:</strong> Filters to VMs in one resource group only.</p>
<hr />
<h3>3. Count VMs by Location</h3>
<div class="codehilite"><pre><span></span><code><span class="n">Resources</span>
<span class="p">|</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="s">&quot;microsoft.compute/virtualmachines&quot;</span><span class="w"> </span>
<span class="p">|</span><span class="w"> </span><span class="k">summarize</span><span class="w"> </span><span class="k">count</span><span class="p">()</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">location</span>
</code></pre></div>

<p><strong>What it does:</strong> Shows how many VMs you have in each Azure region.</p>
<hr />
<h2>Core KQL Concepts</h2>
<h3>Tables = Your Data Sources</h3>
<p>Think of tables like Excel sheets - each contains different types of data:<br />
- <code>Resources</code> = all your Azure resources<br />
- <code>ResourceContainers</code> = subscriptions and resource groups</p>
<h3>Where = Your Filter</h3>
<p>Like Excel filters - narrows down your data:</p>
<div class="codehilite"><pre><span></span><code><span class="p">|</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="s">&quot;microsoft.compute/virtualmachines&quot;</span>
<span class="p">|</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">location</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="s">&quot;eastus&quot;</span>
</code></pre></div>

<p><strong>Always filter early for better performance.</strong></p>
<h3>Project = Your Columns</h3>
<p>Selects which columns to display:</p>
<div class="codehilite"><pre><span></span><code><span class="p">|</span><span class="w"> </span><span class="k">project</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">location</span><span class="p">,</span><span class="w"> </span><span class="n">resourceGroup</span>
</code></pre></div>

<p>Keeps output clean and focused.</p>
<h3>Summarize = Aggregations</h3>
<p>Count, sum, or group your data:</p>
<div class="codehilite"><pre><span></span><code><span class="p">|</span><span class="w"> </span><span class="k">summarize</span><span class="w"> </span><span class="k">count</span><span class="p">()</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">location</span>
<span class="p">|</span><span class="w"> </span><span class="k">summarize</span><span class="w"> </span><span class="n">avg</span><span class="p">(</span><span class="n">properties</span><span class="err">.</span><span class="n">diskSizeGB</span><span class="p">)</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">resourceGroup</span>
</code></pre></div>

<hr />
<h2>15 Essential Queries</h2>
<h3>Query 1: List All VMs</h3>
<div class="codehilite"><pre><span></span><code><span class="n">Resources</span>
<span class="p">|</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="s">&quot;microsoft.compute/virtualmachines&quot;</span>
<span class="p">|</span><span class="w"> </span><span class="k">project</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">location</span><span class="p">,</span><span class="w"> </span><span class="n">resourceGroup</span>
</code></pre></div>

<hr />
<h3>Query 2: List All Storage Accounts</h3>
<div class="codehilite"><pre><span></span><code><span class="n">Resources</span>
<span class="p">|</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="s">&quot;microsoft.storage/storageaccounts&quot;</span>
<span class="p">|</span><span class="w"> </span><span class="k">project</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">location</span><span class="p">,</span><span class="w"> </span><span class="n">resourceGroup</span>
</code></pre></div>

<hr />
<h3>Query 3: Find Resources by Tag</h3>
<div class="codehilite"><pre><span></span><code><span class="n">Resources</span>
<span class="p">|</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">tags</span><span class="p">[</span><span class="s">&quot;Environment&quot;</span><span class="p">]</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="s">&quot;Production&quot;</span>
<span class="p">|</span><span class="w"> </span><span class="k">project</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="p">,</span><span class="w"> </span><span class="n">resourceGroup</span>
</code></pre></div>

<hr />
<h3>Query 4: Count Resources by Type</h3>
<div class="codehilite"><pre><span></span><code><span class="n">Resources</span>
<span class="p">|</span><span class="w"> </span><span class="k">summarize</span><span class="w"> </span><span class="k">count</span><span class="p">()</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">type</span>
<span class="p">|</span><span class="w"> </span><span class="k">order</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">count_</span><span class="w"> </span><span class="n">desc</span>
</code></pre></div>

<hr />
<h3>Query 5: List All Network Interfaces</h3>
<div class="codehilite"><pre><span></span><code><span class="n">Resources</span>
<span class="p">|</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="s">&quot;microsoft.network/networkinterfaces&quot;</span>
<span class="p">|</span><span class="w"> </span><span class="k">project</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">location</span><span class="p">,</span><span class="w"> </span><span class="n">resourceGroup</span>
</code></pre></div>

<hr />
<h3>Query 6: Find Untagged Resources</h3>
<div class="codehilite"><pre><span></span><code><span class="n">Resources</span>
<span class="p">|</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="p">(</span><span class="s">&quot;microsoft.compute/virtualmachines&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;microsoft.storage/storageaccounts&quot;</span><span class="p">)</span>
<span class="p">|</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">isnull</span><span class="p">(</span><span class="n">tags</span><span class="p">)</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="n">array_length</span><span class="p">(</span><span class="n">bag_keys</span><span class="p">(</span><span class="n">tags</span><span class="p">))</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="mi">0</span>
<span class="p">|</span><span class="w"> </span><span class="k">project</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="p">,</span><span class="w"> </span><span class="n">resourceGroup</span>
</code></pre></div>

<hr />
<h3>Query 7: List All Managed Disks</h3>
<div class="codehilite"><pre><span></span><code><span class="n">Resources</span>
<span class="p">|</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="s">&quot;microsoft.compute/disks&quot;</span>
<span class="p">|</span><span class="w"> </span><span class="k">project</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">location</span><span class="p">,</span><span class="w"> </span><span class="n">resourceGroup</span>
</code></pre></div>

<hr />
<h3>Query 8: Count Resources by Location</h3>
<div class="codehilite"><pre><span></span><code><span class="n">Resources</span>
<span class="p">|</span><span class="w"> </span><span class="k">summarize</span><span class="w"> </span><span class="k">count</span><span class="p">()</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">location</span>
<span class="p">|</span><span class="w"> </span><span class="k">order</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">count_</span><span class="w"> </span><span class="n">desc</span>
</code></pre></div>

<hr />
<h3>Query 9: Find VMs with Specific OS</h3>
<div class="codehilite"><pre><span></span><code><span class="n">Resources</span>
<span class="p">|</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="s">&quot;microsoft.compute/virtualmachines&quot;</span>
<span class="p">|</span><span class="w"> </span><span class="k">extend</span><span class="w"> </span><span class="n">OSType</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">tostring</span><span class="p">(</span><span class="n">properties</span><span class="err">.</span><span class="n">storageProfile</span><span class="err">.</span><span class="n">osDisk</span><span class="err">.</span><span class="n">osType</span><span class="p">)</span>
<span class="p">|</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">OSType</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="s">&quot;Linux&quot;</span>
<span class="p">|</span><span class="w"> </span><span class="k">project</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">OSType</span><span class="p">,</span><span class="w"> </span><span class="n">resourceGroup</span>
</code></pre></div>

<hr />
<h3>Query 10: List Public IP Addresses</h3>
<div class="codehilite"><pre><span></span><code><span class="n">Resources</span>
<span class="p">|</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="s">&quot;microsoft.network/publicipaddresses&quot;</span>
<span class="p">|</span><span class="w"> </span><span class="k">project</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">location</span><span class="p">,</span><span class="w"> </span><span class="n">resourceGroup</span>
</code></pre></div>

<hr />
<h3>Query 11: Find Large Disks (&gt;100GB)</h3>
<div class="codehilite"><pre><span></span><code><span class="n">Resources</span>
<span class="p">|</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="s">&quot;microsoft.compute/disks&quot;</span>
<span class="p">|</span><span class="w"> </span><span class="k">extend</span><span class="w"> </span><span class="n">DiskSizeGB</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">toint</span><span class="p">(</span><span class="n">properties</span><span class="err">.</span><span class="n">diskSizeGB</span><span class="p">)</span>
<span class="p">|</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">DiskSizeGB</span><span class="w"> </span><span class="p">&gt;</span><span class="w"> </span><span class="mi">100</span>
<span class="p">|</span><span class="w"> </span><span class="k">project</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">DiskSizeGB</span><span class="p">,</span><span class="w"> </span><span class="n">resourceGroup</span>
</code></pre></div>

<hr />
<h3>Query 12: List All Resource Groups</h3>
<div class="codehilite"><pre><span></span><code><span class="n">ResourceContainers</span>
<span class="p">|</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="s">&quot;microsoft.resources/resourcegroups&quot;</span>
<span class="p">|</span><span class="w"> </span><span class="k">project</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">location</span>
</code></pre></div>

<hr />
<h3>Query 13: Count VMs by Resource Group</h3>
<div class="codehilite"><pre><span></span><code><span class="n">Resources</span>
<span class="p">|</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="s">&quot;microsoft.compute/virtualmachines&quot;</span>
<span class="p">|</span><span class="w"> </span><span class="k">summarize</span><span class="w"> </span><span class="n">VMCount</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">count</span><span class="p">()</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">resourceGroup</span>
<span class="p">|</span><span class="w"> </span><span class="k">order</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">VMCount</span><span class="w"> </span><span class="n">desc</span>
</code></pre></div>

<hr />
<h3>Query 14: Find Resources in Specific Subscription</h3>
<div class="codehilite"><pre><span></span><code><span class="n">Resources</span>
<span class="p">|</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">subscriptionId</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="s">&quot;your-subscription-id-here&quot;</span>
<span class="p">|</span><span class="w"> </span><span class="k">summarize</span><span class="w"> </span><span class="k">count</span><span class="p">()</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">type</span>
</code></pre></div>

<hr />
<h3>Query 15: Get VM with Network Details</h3>
<div class="codehilite"><pre><span></span><code><span class="n">Resources</span>
<span class="p">|</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="s">&quot;microsoft.compute/virtualmachines&quot;</span>
<span class="p">|</span><span class="w"> </span><span class="k">extend</span><span class="w"> </span><span class="n">NetworkInterfaceId</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">tostring</span><span class="p">(</span><span class="n">properties</span><span class="err">.</span><span class="n">networkProfile</span><span class="err">.</span><span class="n">networkInterfaces</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="err">.</span><span class="n">id</span><span class="p">)</span>
<span class="p">|</span><span class="w"> </span><span class="k">project</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">NetworkInterfaceId</span><span class="p">,</span><span class="w"> </span><span class="n">resourceGroup</span>
</code></pre></div>

<hr />
<h2>What You've Learned</h2>
<p>You now know how to:<br />
- ‚úÖ Query Azure Resource Graph<br />
- ‚úÖ Filter resources by type, location, tags<br />
- ‚úÖ Count and aggregate resources<br />
- ‚úÖ Find untagged resources<br />
- ‚úÖ Extract basic properties from resources</p>
<hr />
<h2>üöÄ KQL for Migration Discovery</h2>
<p><strong>Before you touch Azure Migrate</strong>, you need accurate inventory data. These queries answer the 55 questions in the <a href="/products/">Azure Migration Assessment Pro</a> without guesswork.</p>
<h3>Critical Migration Questions KQL Can Answer:</h3>
<p><strong>Infrastructure Discovery:</strong></p>
<div class="codehilite"><pre><span></span><code><span class="c">// Question #10-12: Platform, OS, and Server Count</span>
<span class="n">Resources</span>
<span class="p">|</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="p">=~</span><span class="w"> </span><span class="s">&#39;microsoft.compute/virtualmachines&#39;</span>
<span class="p">|</span><span class="w"> </span><span class="k">extend</span><span class="w"> </span><span class="n">osType</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">properties</span><span class="err">.</span><span class="n">storageProfile</span><span class="err">.</span><span class="n">osDisk</span><span class="err">.</span><span class="n">osType</span>
<span class="p">|</span><span class="w"> </span><span class="k">extend</span><span class="w"> </span><span class="n">osVersion</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">properties</span><span class="err">.</span><span class="n">storageProfile</span><span class="err">.</span><span class="n">imageReference</span><span class="err">.</span><span class="n">sku</span>
<span class="p">|</span><span class="w"> </span><span class="k">summarize</span><span class="w"> </span>
<span class="w">    </span><span class="n">TotalVMs</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">count</span><span class="p">(),</span>
<span class="w">    </span><span class="n">Windows</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">countif</span><span class="p">(</span><span class="n">osType</span><span class="w"> </span><span class="p">=~</span><span class="w"> </span><span class="s">&#39;Windows&#39;</span><span class="p">),</span>
<span class="w">    </span><span class="n">Linux</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">countif</span><span class="p">(</span><span class="n">osType</span><span class="w"> </span><span class="p">=~</span><span class="w"> </span><span class="s">&#39;Linux&#39;</span><span class="p">)</span>
<span class="w">    </span><span class="k">by</span><span class="w"> </span><span class="n">osType</span><span class="p">,</span><span class="w"> </span><span class="n">osVersion</span>
<span class="p">|</span><span class="w"> </span><span class="k">order</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">TotalVMs</span><span class="w"> </span><span class="n">desc</span>
</code></pre></div>

<p><strong>Dependency Mapping:</strong></p>
<div class="codehilite"><pre><span></span><code><span class="c">// Question #15-16: Load Balancer Dependencies &amp; Public Exposure</span>
<span class="n">Resources</span>
<span class="p">|</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="p">=~</span><span class="w"> </span><span class="s">&#39;microsoft.network/loadbalancers&#39;</span>
<span class="p">|</span><span class="w"> </span><span class="k">extend</span><span class="w"> </span><span class="n">frontendConfig</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">properties</span><span class="err">.</span><span class="n">frontendIPConfigurations</span>
<span class="p">|</span><span class="w"> </span><span class="n">mvexpand</span><span class="w"> </span><span class="n">frontendConfig</span>
<span class="p">|</span><span class="w"> </span><span class="k">extend</span><span class="w"> </span>
<span class="w">    </span><span class="n">publicIP</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">frontendConfig</span><span class="err">.</span><span class="n">properties</span><span class="err">.</span><span class="n">publicIPAddress</span><span class="err">.</span><span class="n">id</span><span class="p">,</span>
<span class="w">    </span><span class="n">privateIP</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">frontendConfig</span><span class="err">.</span><span class="n">properties</span><span class="err">.</span><span class="n">privateIPAddress</span>
<span class="p">|</span><span class="w"> </span><span class="k">project</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">resourceGroup</span><span class="p">,</span><span class="w"> </span>
<span class="w">    </span><span class="n">hasPublicIP</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">isnotnull</span><span class="p">(</span><span class="n">publicIP</span><span class="p">),</span>
<span class="w">    </span><span class="n">privateIP</span><span class="p">,</span><span class="w"> </span><span class="n">location</span>
</code></pre></div>

<p><strong>Cost Discovery:</strong></p>
<div class="codehilite"><pre><span></span><code><span class="c">// Question #43-44: Resource Count by Application</span>
<span class="n">Resources</span>
<span class="p">|</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="p">=~</span><span class="w"> </span><span class="s">&#39;microsoft.compute/virtualmachines&#39;</span>
<span class="w">    </span><span class="k">or</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="p">=~</span><span class="w"> </span><span class="s">&#39;microsoft.storage/storageaccounts&#39;</span>
<span class="w">    </span><span class="k">or</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="p">=~</span><span class="w"> </span><span class="s">&#39;microsoft.network/virtualnetworks&#39;</span>
<span class="p">|</span><span class="w"> </span><span class="k">extend</span><span class="w"> </span><span class="n">appName</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">tostring</span><span class="p">(</span><span class="n">tags</span><span class="p">[</span><span class="s">&#39;Application&#39;</span><span class="p">])</span>
<span class="p">|</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">isnotempty</span><span class="p">(</span><span class="n">appName</span><span class="p">)</span>
<span class="p">|</span><span class="w"> </span><span class="k">summarize</span><span class="w"> </span>
<span class="w">    </span><span class="n">VMs</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">countif</span><span class="p">(</span><span class="n">type</span><span class="w"> </span><span class="p">=~</span><span class="w"> </span><span class="s">&#39;microsoft.compute/virtualmachines&#39;</span><span class="p">),</span>
<span class="w">    </span><span class="n">Storage</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">countif</span><span class="p">(</span><span class="n">type</span><span class="w"> </span><span class="p">=~</span><span class="w"> </span><span class="s">&#39;microsoft.storage/storageaccounts&#39;</span><span class="p">),</span>
<span class="w">    </span><span class="n">TotalResources</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">count</span><span class="p">()</span>
<span class="w">    </span><span class="k">by</span><span class="w"> </span><span class="n">appName</span><span class="p">,</span><span class="w"> </span><span class="n">resourceGroup</span>
<span class="p">|</span><span class="w"> </span><span class="k">order</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">TotalResources</span><span class="w"> </span><span class="n">desc</span>
</code></pre></div>

<h3>üéØ The Migration Discovery Workflow:</h3>
<ol>
<li><strong>Run these queries</strong> ‚Üí Answers 25 of 55 migration questions</li>
<li><strong>Export to Excel</strong> ‚Üí Paste into <a href="/products/">Migration Assessment Pro</a></li>
<li><strong>Auto-fill confidence</strong> ‚Üí High (KQL-verified), not Low (guessed)</li>
<li><strong>Remaining 30 questions</strong> ‚Üí Manual discovery (app owners, licensing docs)</li>
</ol>
<p><strong>Time saved:</strong> 10-15 hours per application</p>
<h3>Want All 48 Migration Discovery Queries?</h3>
<p>The <a href="https://davidnoob.gumroad.com/l/hooih">Complete KQL Query Library ($19)</a> includes:<br />
- ‚úÖ <strong>Dependency mapping queries</strong> - Find load balancers, VNets, NSGs per app<br />
- ‚úÖ <strong>Licensing audits</strong> - SQL Server, Windows, Red Hat detection<br />
- ‚úÖ <strong>Cost allocation</strong> - Tag-based resource grouping for cost estimates<br />
- ‚úÖ <strong>Security assessment</strong> - Encryption status, public exposure, NSG rules</p>
<p><strong>Maps directly to the Migration Assessment Pro questionnaire.</strong></p>
<hr />
<h2>üöÄ Want the Complete KQL Library?</h2>
<p>This free guide covers the <strong>fundamentals</strong> - 15 essential queries to get started.</p>
<p><strong>Ready for production-level Azure administration?</strong> </p>
<h3>Get the Complete KQL Query Library ($19)</h3>
<p><strong>What's included:</strong><br />
- ‚úÖ <strong>48 production-tested queries</strong> (vs 15 basic queries here)<br />
- ‚úÖ <strong>Advanced joins</strong> - Link VMs to NICs, disks, subnets, subscriptions<br />
- ‚úÖ <strong>Performance optimization guide</strong> - Query 31,000+ resources efficiently<br />
- ‚úÖ <strong>SQL to KQL translation</strong> - For SQL developers learning KQL<br />
- ‚úÖ <strong>Case-insensitive tag handling</strong> - Handles tag variations automatically<br />
- ‚úÖ <strong>Power state detection</strong> - Show IPs only for running VMs<br />
- ‚úÖ <strong>Real production scenarios</strong> - From managing enterprise-scale Azure<br />
- ‚úÖ <strong>JSON query files</strong> - Copy-paste ready for immediate use<br />
- ‚úÖ <strong>Complete reference guide</strong> - All queries organized by category<br />
- ‚úÖ <strong>Troubleshooting guide</strong> - Fix common KQL errors<br />
- ‚úÖ <strong>Future updates included</strong> - Get new queries as Azure evolves</p>
<p><strong>Used in production managing:</strong><br />
- 44 Azure subscriptions<br />
- 31,000+ resources<br />
- Enterprise-scale environments</p>
<h3>Why Upgrade?</h3>
<p><strong>This free guide teaches you KQL basics</strong> ‚Üí Get started in 30 minutes</p>
<p><strong>The complete library gives you production-ready queries</strong> ‚Üí Save 10+ hours/month</p>
<p><strong>Price: $19</strong> (one-time purchase, instant download)</p>
<p><a href="https://davidnoob.gumroad.com/l/hooih">Get the Complete KQL Library ‚Üí</a></p>
<p><em>Money-back guarantee if it doesn't save you 2+ hours in the first week.</em></p>
<hr />
<h2>Additional Resources</h2>
<ul>
<li><a href="https://docs.microsoft.com/en-us/azure/data-explorer/kql-quick-reference">KQL Quick Reference (Microsoft)</a></li>
<li><a href="https://docs.microsoft.com/en-us/azure/governance/resource-graph/">Azure Resource Graph Documentation</a></li>
<li><a href="https://azure-noob.com">More Azure insights at azure-noob.com</a></li>
</ul>
<hr />
<h3>Azure Admin Starter Kit (Free Download)</h3>
<p>Get my complete Azure admin toolkit: KQL cheat sheet, 50 Windows + 50 Linux commands, and an Azure RACI template in one free bundle.</p>
<p><a href="/blog/starter-kit/">Get the Starter Kit ‚Üí</a></p>
<hr />
<p><em>Want to learn more about Azure governance, cost management, and operations? Visit <a href="https://azure-noob.com">azure-noob.com</a> for practical guides based on real enterprise experience.</em></p>
  </div>

  
  <section class="starter-kit-callout" style="
    max-width: 800px;
    margin: 3rem auto 2rem;
    padding: 2rem;
    border-radius: 12px;
    background: var(--bg-light);
    border: 1px solid var(--border);
    text-align: left;
  ">
    <h3 style="margin-top: 0;">Azure Admin Starter Kit (Free Download)</h3>
    <p style="margin-bottom: 1rem;">
      Get my KQL cheat sheet, 50 Windows + 50 Linux commands, and an Azure RACI template in one free bundle.
    </p>
    <a href="/blog/starter-kit/" class="btn">Get the Starter Kit ‚Üí</a>
  </section>

  
  <aside class="email-capture" style="max-width: 800px; margin: 4rem auto; padding: 3rem; background: linear-gradient(135deg, #0078d4 0%, #005a9e 100%); border-radius: 12px; text-align: center; color: white;">
    <h3 style="margin-top: 0; color: white; font-size: 1.75rem;">Get Azure operational guides in your inbox</h3>
    <p style="margin: 1rem 0 2rem; font-size: 1.1rem; color: white;">Weekly tips from managing 44 Azure subscriptions. No marketing BS.</p>
    
    <form action="https://app.kit.com/forms/8896829/subscriptions" method="post" style="max-width: 500px; margin: 0 auto; display: flex; gap: 0.75rem; flex-wrap: wrap; justify-content: center;">
      <input type="email" 
             name="email_address" 
             placeholder="your@email.com" 
             required 
             style="flex: 1; min-width: 250px; padding: 0.875rem 1rem; border: none; border-radius: 8px; font-size: 1rem; color: #333;">
      <button type="submit" 
              style="padding: 0.875rem 2rem; background: white; color: #0078d4; border: none; border-radius: 8px; font-weight: 700; cursor: pointer; white-space: nowrap; font-size: 1rem; transition: all 0.2s;">
        Subscribe
      </button>
    </form>
    
    <p style="margin: 1.5rem 0 0; font-size: 0.9rem; opacity: 0.9; color: white;">
      Join 500+ Azure admins. Unsubscribe anytime.
    </p>
  </aside>

  
  
  <aside class="related-posts" style="max-width: 800px; margin: 3rem auto; padding: 2rem; background: var(--bg-light); border-radius: 12px;">
    <h3 style="margin-top: 0;">Related Posts</h3>
    <ul style="list-style: none; padding: 0;">
      
      <li style="margin: 1rem 0;">
        <a href="/blog/kql-cheat-sheet-FREE" style="display: block; padding: 1rem; background: white; border-radius: 8px; border: 1px solid var(--border); transition: all 0.2s ease;">
          <span class="related-title" style="font-weight: 700; display: block; color: var(--text-dark);">KQL Cheat Sheet: Getting Started with Azure Resource Graph</span>
          <span class="related-meta" style="color: var(--text-muted); font-size: 0.9rem;">2025-01-15</span>
        </a>
      </li>
      
      <li style="margin: 1rem 0;">
        <a href="/blog/kql-multiple-systems" style="display: block; padding: 1rem; background: white; border-radius: 8px; border: 1px solid var(--border); transition: all 0.2s ease;">
          <span class="related-title" style="font-weight: 700; display: block; color: var(--text-dark);">KQL Across 5 Azure Systems: The Query Compatibility Guide</span>
          <span class="related-meta" style="color: var(--text-muted); font-size: 0.9rem;">2025-10-24</span>
        </a>
      </li>
      
      <li style="margin: 1rem 0;">
        <a href="/blog/pull-meta-from-arm" style="display: block; padding: 1rem; background: white; border-radius: 8px; border: 1px solid var(--border); transition: all 0.2s ease;">
          <span class="related-title" style="font-weight: 700; display: block; color: var(--text-dark);">I&#39;ll Pull The Meta From ARM - What 6 Months of KQL Actually Looks Like</span>
          <span class="related-meta" style="color: var(--text-muted); font-size: 0.9rem;">2025-11-10</span>
        </a>
      </li>
      
    </ul>
  </aside>
  

  
  
  
    <!-- CTA: KQL Query Library -->
<div class="cta-block" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); padding: 2rem; border-radius: 8px; margin: 3rem 0; text-align: center; color: white;">
  <h3 style="margin: 0 0 1rem; font-size: 1.75rem; color: white;">üìä Stop Rewriting the Same KQL Queries</h3>
  <p style="margin: 0 0 1.5rem; font-size: 1.1rem; line-height: 1.6;">
    Get <strong>45+ production-ready KQL queries</strong> for Azure Resource Graph, Log Analytics, and Activity Logs.
    Copy-paste ready with comments and business context.
  </p>
  <a href="/static/downloads/KQL-Query-Library-Complete.pdf" 
     download
     style="display: inline-block; padding: 0.75rem 2rem; background: white; color: #f5576c; text-decoration: none; border-radius: 6px; font-weight: 700; font-size: 1.1rem; box-shadow: 0 4px 12px rgba(0,0,0,0.15); transition: all 0.3s ease;"
     onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 6px 20px rgba(0,0,0,0.2)'"
     onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 12px rgba(0,0,0,0.15)'">
    Download Complete Query Library
  </a>
  <p style="margin: 1rem 0 0; font-size: 0.9rem; opacity: 0.9;">
    PDF format ‚Ä¢ No email required ‚Ä¢ Instant download
  </p>
</div>
  

  
  <nav class="post-nav">
    
      <a href="/blog/kql-cheat-sheet-FREE">
        <span style="opacity: 0.7; font-size: 0.85rem; display: block; margin-bottom: 0.25rem;">‚Üê Previous</span>
        <strong>KQL Cheat Sheet: Getting Started with Azure Resource Graph</strong>
      </a>
    
    
      <a href="/blog/azure-vm-inventory-kql" style="text-align: right;">
        <span style="opacity: 0.7; font-size: 0.85rem; display: block; margin-bottom: 0.25rem;">Next ‚Üí</span>
        <strong>From Raw Data to Actionable Insights: Mastering Azure VM Inventory with KQL</strong>
      </a>
    
  </nav>

</article>

    </div>
  </main>

  <footer class="site-footer">
    <div class="wrap">
      <p>&copy; 2025 Azure Noob ‚Äî Don&#39;t be a Noob</p>
      <p style="margin-top: 0.5rem; font-size: 0.9rem;">
        <a href="/rss.xml" title="Subscribe via RSS">RSS Feed</a> ¬∑ 
        <a href="https://github.com/dswann101164" target="_blank" rel="noopener">GitHub</a>
      </p>
      <p style="margin-top: 1.5rem; font-size: 0.85rem; opacity: 0.7; font-style: italic;">
        "Trust in the Lord with all your heart, and lean not on your own understanding;<br>
        in all your ways acknowledge Him, and He will make your paths straight" ‚Äî Proverbs 3:5-6
      </p>
    </div>
  </footer>

  <!-- Copy code functionality -->
  <script src="/static/copy-code.js"></script>

  <!-- Exit-Intent Popup -->
  <div id="exit-popup" class="exit-popup" style="display: none;">
    <div class="exit-popup-content">
      <button class="exit-popup-close" onclick="closeExitPopup()">&times;</button>
      <h2>Wait! Before You Go...</h2>
      <p class="exit-popup-subtitle">Get the <strong>FREE Azure Admin Starter Kit</strong></p>
      <ul class="exit-popup-benefits">
        <li>‚úì 15 Essential KQL Queries</li>
        <li>‚úì 50 Windows Commands</li>
        <li>‚úì 50 Linux Commands</li>
      </ul>
      <form id="exit-popup-form" class="exit-popup-form">
        <input type="email" id="popup-email" placeholder="Enter your email" required>
        <button type="submit" class="exit-popup-submit">Send Me The Free Kit</button>
      </form>
      <p class="exit-popup-privacy">We'll also notify you about new tools & guides. Unsubscribe anytime.</p>
    </div>
  </div>

  <style>
  .exit-popup {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.8);
    z-index: 10000;
    display: flex;
    align-items: center;
    justify-content: center;
    animation: fadeIn 0.3s ease;
  }

  @keyframes fadeIn {
    from { opacity: 0; }
    to { opacity: 1; }
  }

  .exit-popup-content {
    background: white;
    padding: 2.5rem;
    border-radius: 12px;
    max-width: 500px;
    width: 90%;
    position: relative;
    box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
    animation: slideUp 0.3s ease;
  }

  @keyframes slideUp {
    from { transform: translateY(50px); opacity: 0; }
    to { transform: translateY(0); opacity: 1; }
  }

  .exit-popup-close {
    position: absolute;
    top: 1rem;
    right: 1rem;
    background: none;
    border: none;
    font-size: 2rem;
    cursor: pointer;
    color: #999;
    line-height: 1;
  }

  .exit-popup-close:hover {
    color: #333;
  }

  .exit-popup h2 {
    margin: 0 0 0.5rem 0;
    color: #0078d4;
    font-size: 2rem;
  }

  .exit-popup-subtitle {
    font-size: 1.2rem;
    margin: 0 0 1.5rem 0;
  }

  .exit-popup-benefits {
    list-style: none;
    padding: 0;
    margin: 1.5rem 0;
  }

  .exit-popup-benefits li {
    padding: 0.5rem 0;
    font-size: 1.1rem;
  }

  .exit-popup-form {
    margin: 1.5rem 0;
  }

  .exit-popup-form input[type="email"] {
    width: 100%;
    padding: 1rem;
    border: 2px solid #ddd;
    border-radius: 6px;
    font-size: 1rem;
    margin-bottom: 1rem;
  }

  .exit-popup-form input[type="email"]:focus {
    outline: none;
    border-color: #0078d4;
  }

  .exit-popup-submit {
    width: 100%;
    padding: 1rem 2rem;
    background: #0078d4;
    color: white;
    border: none;
    border-radius: 6px;
    font-size: 1.1rem;
    font-weight: bold;
    cursor: pointer;
    transition: background 0.2s;
  }

  .exit-popup-submit:hover {
    background: #005a9e;
  }

  .exit-popup-privacy {
    font-size: 0.85rem;
    color: #666;
    margin-top: 1rem;
    text-align: center;
  }
  </style>

  <script>
  // Exit-intent detection
  let exitPopupShown = false;
  let mouseY = 0;

  document.addEventListener('mousemove', (e) => {
    mouseY = e.clientY;
  });

  document.addEventListener('mouseout', (e) => {
    // If mouse leaves through top of viewport and popup hasn't been shown
    if (!exitPopupShown && e.clientY <= 0 && mouseY <= 100) {
      // Check if user has seen it before (session storage)
      if (!sessionStorage.getItem('exitPopupSeen')) {
        showExitPopup();
      }
    }
  });

  function showExitPopup() {
    exitPopupShown = true;
    document.getElementById('exit-popup').style.display = 'flex';
    sessionStorage.setItem('exitPopupSeen', 'true');
  }

  function closeExitPopup() {
    document.getElementById('exit-popup').style.display = 'none';
  }

  // Handle form submission
  document.getElementById('exit-popup-form').addEventListener('submit', async (e) => {
    e.preventDefault();
    const email = document.getElementById('popup-email').value;
    
    // Send to Kit (ConvertKit)
    try {
      const FORM_ID = '8896829'; // Your Kit Form ID
      
      const response = await fetch(`https://api.convertkit.com/v3/forms/${FORM_ID}/subscribe`, {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify({
          email: email
        })
      });
      
      if (response.ok) {
        console.log('‚úÖ Email captured to Kit:', email);
      }
      
      closeExitPopup();
      
      // Track in Google Analytics
      if (typeof gtag !== 'undefined') {
        gtag('event', 'signup', {
          'event_category': 'email',
          'event_label': 'exit_popup',
          'value': email
        });
      }
      
      // Redirect to starter kit page
      window.location.href = '/blog/starter-kit/';
      
    } catch (error) {
      console.error('Error:', error);
      // Still redirect even if tracking fails
      window.location.href = '/blog/starter-kit/';
    }
  });

  // Close on background click
  document.getElementById('exit-popup').addEventListener('click', (e) => {
    if (e.target.id === 'exit-popup') {
      closeExitPopup();
    }
  });
  </script>
</body>
</html>